(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63179,       1635]
NotebookOptionsPosition[     61695,       1587]
NotebookOutlinePosition[     62028,       1602]
CellTagsIndexPosition[     61985,       1599]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Block\[CloseCurlyQuote]s stuff", "Section",
 CellChangeTimes->{{3.681800479513413*^9, 3.6818004874447823`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", 
    RowBox[{"H_", ",", "Rt_", ",", "\[Mu]_", ",", "R_"}], "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"R", "/", "Rt"}], " ", "H"}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", "H", "]"}], "<=", 
         RowBox[{"\[Mu]", " ", "Rt"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sign", "[", "H", "]"}], "\[Mu]", " ", "R"}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", "H", "]"}], ">", 
         RowBox[{"\[Mu]", " ", "Rt"}]}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"switchLR", "[", "p_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "pnew", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"pnew", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "20", "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{"switch", " ", "normal", " ", "forces"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"p", "[", 
        RowBox[{"[", 
         RowBox[{"17", ";;", "20", ";;", "2"}], "]"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"17", ";;", "20", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"p", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4", ";;", "2"}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Ls", "\[UndirectedEdge]", "Ld"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"5", ";;", "9", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"p", "[", 
        RowBox[{"[", 
         RowBox[{"9", ";;", "5", ";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Ns", "\[UndirectedEdge]", "Nc", "\[UndirectedEdge]", "Nd"}], 
       "*)"}], "\n", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"11", ";;", "15", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"p", "[", 
        RowBox[{"[", 
         RowBox[{"15", ";;", "11", ";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Rs", "\[UndirectedEdge]", "Rc", "\[UndirectedEdge]", "Rd"}], 
       "*)"}], "\n", 
      RowBox[{"(*", 
       RowBox[{"switch", " ", "tangential", " ", "forces"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", "4", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"p", "[", 
         RowBox[{"[", 
          RowBox[{"18", ";;", "20", ";;", "2"}], "]"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"18", ";;", "20", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"p", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", "4", ";;", "2"}], "]"}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Vsu", "\[UndirectedEdge]", "Vdu"}], ",", 
        RowBox[{"Vsb", "\[UndirectedEdge]", "Vdb"}]}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"6", ";;", "10", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"p", "[", 
         RowBox[{"[", 
          RowBox[{"10", ";;", "6", ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Ts", "\[UndirectedEdge]", "Td"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"12", ";;", "16", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"p", "[", 
         RowBox[{"[", 
          RowBox[{"16", ";;", "12", ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Vs", "\[UndirectedEdge]", "Vc", "\[UndirectedEdge]", "Vd"}], 
       "*)"}], "\n", "\n", "pnew"}]}], "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveBlockL2R", "[", 
    RowBox[{"pBlock_", ",", "contact_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
       "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", "Rc",
        ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", "Ldb", 
       ",", "Vdb", ",", "Ms", ",", "Mc", ",", "Md", ",", "H", ",", "Rt"}], 
      "}"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
         "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", 
         "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", 
         "Ldb", ",", "Vdb"}], "}"}], "=", "pBlock"}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"solution", " ", "left", " ", "to", " ", "right"}], "*)"}], 
      "\n", 
      RowBox[{"Ldu", "=", "0"}], ";", 
      RowBox[{"Vdu", "=", "0"}], ";", 
      RowBox[{"Ldb", "=", "0"}], ";", 
      RowBox[{"Vdb", "=", "0"}], ";", "\n", 
      RowBox[{"Md", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ns", "+", "Vsu", "+", "Vsb", "+", 
           RowBox[{"Nc", "/", "2"}], "+", 
           RowBox[{"P", "/", "2"}]}], ")"}], "b"}], "-", 
        RowBox[{"h", 
         RowBox[{"(", 
          RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
          ")"}]}]}]}], ";", "\n", 
      RowBox[{"Ms", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Nc", "/", "2"}], "+", 
           RowBox[{"P", "/", "2"}], "+", "Nd", "-", "Vdu", "-", "Vdb"}], 
          ")"}], "b"}], "+", 
        RowBox[{"h", 
         RowBox[{"(", 
          RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
          ")"}]}]}]}], ";", "\n", 
      RowBox[{"Mc", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "Ns", "+", "Vsu", "+", "Vsb", "-", "Nd", "+", "Vdu", "+", "Vdb"}], 
          ")"}], 
         RowBox[{"b", "/", "2"}]}], "-", 
        RowBox[{"h", 
         RowBox[{"(", 
          RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
          ")"}]}]}]}], ";", "\n", 
      RowBox[{"Rt", "=", 
       RowBox[{
       "Vsu", "+", "Vsb", "+", "Ns", "+", "Nc", "+", "P", "+", "Nd", "-", 
        "Vdu", "-", "Vdb"}]}], ";", "\n", 
      RowBox[{"H", "=", 
       RowBox[{
       "Lsu", "+", "Lsb", "+", "Ts", "+", "Tc", "+", "Td", "-", "Ldu", "-", 
        "Ldb"}]}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"contact", "==", "1"}], ",", "\n", 
        RowBox[{"(*", 
         RowBox[{"meccanismo", " ", "1"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"Rc", "=", "0"}], ";", "\n", 
         RowBox[{"Rs", "=", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Md", "/", "b"}], ",", "0"}], "]"}]}], ";", "\n", 
         RowBox[{"Rd", "=", 
          RowBox[{"Rt", "-", "Rs"}]}], ";"}], ",", "\n", 
        RowBox[{"(*", 
         RowBox[{"meccanismo", " ", "2", " ", "e", " ", "3"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"Rs", "=", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Mc", "/", 
             RowBox[{"(", 
              RowBox[{"b", "/", "2"}], ")"}]}], ",", "0"}], "]"}]}], ";", 
         "\n", 
         RowBox[{"Rd", "=", 
          RowBox[{"Piecewise", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "Mc"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"b", "/", "2"}], ")"}]}], ",", "0"}], "]"}], ",", 
               RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Rt", ",", 
               RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
         RowBox[{"Rc", "=", 
          RowBox[{"Piecewise", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"Rt", "-", "Rs", "-", "Rd"}], ",", "0"}], "]"}], ",", 
               RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";"}]}], 
       "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"Ldu", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Md"}], "/", "h"}], ",", "0"}], "]"}]}], ";", "\n", 
      RowBox[{"Vs", "=", 
       RowBox[{"V", "[", 
        RowBox[{"H", ",", "Rt", ",", "\[Mu]", ",", "Rs"}], "]"}]}], ";", "\n", 
      RowBox[{"Vc", "=", 
       RowBox[{"V", "[", 
        RowBox[{"H", ",", "Rt", ",", "\[Mu]", ",", "Rc"}], "]"}]}], ";", "\n", 
      RowBox[{"Vd", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"H", ",", "Rt", ",", "\[Mu]", ",", "Rd"}], "]"}], ",", 
            RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"H", "-", "Ldu"}], ",", 
              RowBox[{"\[Mu]", " ", "Rd"}]}], "]"}], ",", 
            RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
      RowBox[{"Ldb", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"H", "-", 
               RowBox[{"\[Mu]", " ", "Rt"}]}], ",", "0"}], "]"}], ",", 
            RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"H", "-", "Ldu", "-", "Vd"}], ",", 
            RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"{", 
       RowBox[{
       "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
        "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", 
        "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", 
        "Ldb", ",", "Vdb"}], "}"}]}]}], "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveBlockR2L", "[", 
    RowBox[{"pBlock_", ",", "contact_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "pBlockR2L", "}"}], ",", "\n", 
     RowBox[{"switchLR", "[", 
      RowBox[{"solveBlockL2R", "[", 
       RowBox[{
        RowBox[{"switchLR", "[", "pBlock", "]"}], ",", "contact"}], "]"}], 
      "]"}]}], "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveBlock", "[", 
    RowBox[{"pBlock_", ",", "contact_", ",", "dir_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dir", ">", "0"}], ",", "\n", 
       RowBox[{"solveBlockL2R", "[", 
        RowBox[{"pBlock", ",", "contact"}], "]"}], ",", "\n", 
       RowBox[{"solveBlockR2L", "[", 
        RowBox[{"pBlock", ",", "contact"}], "]"}]}], "]"}]}], "\n", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.681906931491468*^9, 3.681906936381888*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wall\[CloseCurlyQuote]s stuff", "Section",
 CellChangeTimes->{{3.6818006720196657`*^9, 3.681800675352103*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getBlockNum", "[", 
     RowBox[{"{", 
      RowBox[{"nRow_", ",", "j_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "nBlock", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"EvenQ", "[", "nRow", "]"}], ",", "\n", 
         RowBox[{
          RowBox[{"nBlock", "=", 
           RowBox[{
            RowBox[{"nelx", " ", 
             RowBox[{"nRow", "/", "2"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nelx", "-", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"nRow", "/", "2"}], "-", "1"}], ")"}]}]}]}], ";"}], 
         ",", "\n", 
         RowBox[{
          RowBox[{"nBlock", "=", 
           RowBox[{
            RowBox[{"nelx", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nRow", "-", "1"}], ")"}], "/", "2"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nelx", "-", "1"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nRow", "-", "1"}], ")"}], "/", "2"}]}]}]}], ";"}]}], 
        "\n", "]"}], ";", "\n", "\n", 
       RowBox[{"nBlock", "+=", "j"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"isBlockOnRightEdge", "[", 
     RowBox[{"{", 
      RowBox[{"nRow_", ",", "j_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "nRow", "]"}], ",", "\n", 
        RowBox[{"j", "==", 
         RowBox[{"nelx", "-", "1"}]}], ",", "\n", 
        RowBox[{"j", "==", "nelx"}]}], "]"}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"isBlockOnLeftEdge", "[", 
    RowBox[{"{", 
     RowBox[{"nRow_", ",", "j_"}], "}"}], "]"}], ":=", 
   RowBox[{"j", "==", "1"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.681800031678328*^9, 3.681800069797719*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"findSolvableBlockSequence", "[", "nRow_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "j", ",", "shear", ",", "rowShears", ",", "blockSequence", ",", "len", 
       ",", "direction", ",", " ", "result"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rowShears", "=", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"\[Sigma]v", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"getBlockNum", "[", 
              RowBox[{"{", 
               RowBox[{"nRow", ",", "1"}], "}"}], "]"}], ";;", 
             RowBox[{"getBlockNum", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"nRow", "+", "1"}], ",", "0"}], "}"}], "]"}]}], ",", 
            RowBox[{"2", ";;", "6", ";;", "2"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rowShears", "=", 
       RowBox[{"SplitBy", "[", 
        RowBox[{"rowShears", ",", 
         RowBox[{
          RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"blockSequence", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"len", "=", "0"}], ";", 
      RowBox[{"direction", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", 
         RowBox[{"Length", "[", "rowShears", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"shear", "=", 
          RowBox[{"Total", "[", 
           RowBox[{"rowShears", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"blockSequence", ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"len", "+", "1"}], ",", 
             RowBox[{"len", "+", 
              RowBox[{"Length", "[", 
               RowBox[{"rowShears", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], "]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"shear", "<", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"blockSequence", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", 
             RowBox[{"Reverse", "[", 
              RowBox[{"blockSequence", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"direction", ",", 
              RowBox[{"-", "1"}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"direction", ",", "1"}], "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"len", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"Flatten", "[", "blockSequence", "]"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "[", "\"\<seq\>\"", "]"}], "=", "blockSequence"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"result", "[", "\"\<dir\>\"", "]"}], "=", "direction"}], ";", 
      "\[IndentingNewLine]", "result"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.681899769052169*^9, 3.681899885717478*^9}, {
   3.681899940058683*^9, 3.681900017577824*^9}, {3.681901312742299*^9, 
   3.681901434610629*^9}, {3.6819015047968283`*^9, 3.6819015174604483`*^9}, {
   3.681901684018691*^9, 3.6819017250125847`*^9}, {3.6819017637702703`*^9, 
   3.681902029621675*^9}, {3.681902106090087*^9, 3.681902106430168*^9}, {
   3.681902247902404*^9, 3.6819022530976763`*^9}, {3.681902347524686*^9, 
   3.681902347768673*^9}, {3.6819023999115677`*^9, 3.6819024027288446`*^9}, 
   3.681902940225539*^9, {3.6819038837404833`*^9, 3.68190392006851*^9}, {
   3.681903957412323*^9, 3.6819039949205236`*^9}, {3.681904680632333*^9, 
   3.68190469055505*^9}, {3.6819048493912773`*^9, 3.681904933280774*^9}, {
   3.6819059555979652`*^9, 3.681906007774544*^9}, 3.681906071472247*^9, {
   3.681906755860546*^9, 3.6819067892197437`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getBlockLoads", "[", 
    RowBox[{"{", 
     RowBox[{"nRow_", ",", "j_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pvnew", ",", "Ns", ",", "Ts", ",", "Ncs", ",", "Tcs", ",", "Ncd", ",", 
       "Tcd", ",", "Nd", ",", "Td", ",", "nBlock", ",", "blockULPos", ",", 
       "blockURPos", ",", "nBlockUL", ",", "nBlockUR"}], "}"}], ",", 
     RowBox[{
      RowBox[{"nBlock", "=", 
       RowBox[{"getBlockNum", "[", 
        RowBox[{"{", 
         RowBox[{"nRow", ",", "j"}], "}"}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nRow", "==", "1"}], ",", "\n", "\n", 
        RowBox[{"(*", 
         RowBox[{"first", " ", "row"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"pvnew", "=", 
          RowBox[{"\[Sigma]v", "[", 
           RowBox[{"[", "nBlock", "]"}], "]"}]}], ";"}], ",", "\n", "\n", 
        RowBox[{"(*", 
         RowBox[{"other", " ", "rows"}], "*)"}], "\n", 
        RowBox[{"(*", 
         RowBox[{"get", " ", "upper", " ", 
          RowBox[{"blocks", "'"}], " ", "positions"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"EvenQ", "[", "nRow", "]"}], ",", "\n", 
           RowBox[{
            RowBox[{"blockULPos", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nRow", "-", "1"}], ",", "j"}], "}"}]}], ";", 
            RowBox[{"blockURPos", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nRow", "-", "1"}], ",", 
               RowBox[{"j", "+", "1"}]}], "}"}]}], ";"}], ",", "\n", 
           RowBox[{
            RowBox[{"blockULPos", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nRow", "-", "1"}], ",", 
               RowBox[{"j", "-", "1"}]}], "}"}]}], ";", 
            RowBox[{"blockURPos", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nRow", "-", "1"}], ",", "j"}], "}"}]}], ";"}]}], "\n", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"isBlockOnLeftEdge", "[", 
               RowBox[{"{", 
                RowBox[{"nRow", ",", "j"}], "}"}], "]"}], ",", "\n", 
              RowBox[{
               RowBox[{"blockULPos", "=", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], ";"}]}], "\n", "]"}], ";", 
            "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"isBlockOnRightEdge", "[", 
               RowBox[{"{", 
                RowBox[{"nRow", ",", "j"}], "}"}], "]"}], ",", "\n", 
              RowBox[{
               RowBox[{"blockURPos", "=", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], ";"}]}], "\n", "]"}], 
            ";"}], "*)"}], "\n", "]"}], ";", "\n", 
         RowBox[{"nBlockUL", "=", 
          RowBox[{"getBlockNum", "[", "blockULPos", "]"}]}], ";", "\n", 
         RowBox[{"nBlockUR", "=", 
          RowBox[{"getBlockNum", "[", "blockURPos", "]"}]}], ";", "\n", "\n", 
         
         RowBox[{"(*", 
          RowBox[{
          "get", " ", "loads", " ", "acting", " ", "on", " ", "top", " ", 
           "from", " ", "the", " ", "reactions", " ", "of", " ", "the", " ", 
           "upper", " ", "blocks"}], "*)"}], "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"isBlockOnLeftEdge", "[", 
               RowBox[{"{", 
                RowBox[{"nRow", ",", "j"}], "}"}], "]"}], "||", 
              RowBox[{"isBlockOnRightEdge", "[", 
               RowBox[{"{", 
                RowBox[{"nRow", ",", "j"}], "}"}], "]"}]}], ")"}]}], ",", 
           "\n", 
           RowBox[{"(*", 
            RowBox[{"block", " ", "is", " ", "internal"}], "*)"}], "\n", 
           RowBox[{
            RowBox[{"Ncs", "=", 
             RowBox[{"\[Sigma]v", "[", 
              RowBox[{"[", 
               RowBox[{"nBlockUL", ",", "11"}], "]"}], "]"}]}], ";", 
            RowBox[{"Tcs", "=", 
             RowBox[{"\[Sigma]v", "[", 
              RowBox[{"[", 
               RowBox[{"nBlockUL", ",", "12"}], "]"}], "]"}]}], ";", "\n", 
            RowBox[{"Ncd", "=", 
             RowBox[{"\[Sigma]v", "[", 
              RowBox[{"[", 
               RowBox[{"nBlockUR", ",", "7"}], "]"}], "]"}]}], ";", 
            RowBox[{"Tcd", "=", 
             RowBox[{"\[Sigma]v", "[", 
              RowBox[{"[", 
               RowBox[{"nBlockUR", ",", "8"}], "]"}], "]"}]}], ";", "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"contacts", "[", 
                RowBox[{"[", "nBlockUL", "]"}], "]"}], "==", "3"}], ",", "\n", 
              RowBox[{
               RowBox[{"Ns", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUL", ",", "9"}], "]"}], "]"}]}], ";", 
               RowBox[{"Ts", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUL", ",", "10"}], "]"}], "]"}]}], ";"}], ",",
               "\n", 
              RowBox[{
               RowBox[{"Ns", "=", "0"}], ";", 
               RowBox[{"Ts", "=", "0"}], ";"}]}], "\n", "]"}], ";", "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"contacts", "[", 
                RowBox[{"[", "nBlockUR", "]"}], "]"}], "==", "2"}], ",", "\n", 
              RowBox[{
               RowBox[{"Nd", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUR", ",", "9"}], "]"}], "]"}]}], ";", 
               RowBox[{"Td", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUR", ",", "10"}], "]"}], "]"}]}], ";"}], ",",
               "\n", 
              RowBox[{
               RowBox[{"Nd", "=", "0"}], ";", 
               RowBox[{"Td", "=", "0"}], ";"}]}], "\n", "]"}], ";"}], ",", 
           "\n", "\n", 
           RowBox[{"(*", 
            RowBox[{"block", " ", "in", " ", "not", " ", "internal"}], "*)"}],
            "\n", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"isBlockOnLeftEdge", "[", 
               RowBox[{"{", 
                RowBox[{"nRow", ",", "j"}], "}"}], "]"}], ",", 
              RowBox[{"(*", 
               RowBox[{"TODO", ":", " ", 
                RowBox[{"modify", " ", "to", " ", "support", " ", "edge", " ", 
                 RowBox[{"blocks", "!"}]}]}], "*)"}], "\n", 
              RowBox[{"(*", 
               RowBox[{
               "block", " ", "on", " ", "the", " ", "left", " ", "edge"}], 
               "*)"}], "\n", 
              RowBox[{
               RowBox[{"Ncd", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUR", ",", "7"}], "]"}], "]"}]}], ";", 
               RowBox[{"Tcd", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUR", ",", "8"}], "]"}], "]"}]}], ";", "\n", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"contacts", "[", 
                   RowBox[{"[", "nBlockUR", "]"}], "]"}], "==", "2"}], ",", 
                 "\n", 
                 RowBox[{
                  RowBox[{"Nd", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUR", ",", "9"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Td", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUR", ",", "10"}], "]"}], "]"}]}], ";"}], 
                 ",", "\n", 
                 RowBox[{
                  RowBox[{"Nd", "=", "0"}], ";", 
                  RowBox[{"Td", "=", "0"}], ";"}]}], "\n", "]"}], ";", "\n", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"EvenQ", "[", "nRow", "]"}], ",", "\n", 
                 RowBox[{
                  RowBox[{"Ns", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUL", ",", "9"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Ts", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUL", ",", "10"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Ncs", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUL", ",", "11"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Tcs", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUL", ",", "12"}], "]"}], "]"}]}], ";"}], 
                 ",", "\n", 
                 RowBox[{
                  RowBox[{"Ns", "=", "0"}], ";", 
                  RowBox[{"Ts", "=", "0"}], ";", 
                  RowBox[{"Ncs", "=", "0"}], ";", 
                  RowBox[{"Tcs", "=", "0"}], ";"}]}], "\n", "]"}], ";"}], ",",
               "\n", 
              RowBox[{"(*", 
               RowBox[{
               "block", " ", "on", " ", "the", " ", "right", " ", "edge"}], 
               "*)"}], "\n", 
              RowBox[{
               RowBox[{"Ncs", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUL", ",", "11"}], "]"}], "]"}]}], ";", 
               RowBox[{"Tcs", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUL", ",", "12"}], "]"}], "]"}]}], ";", "\n", 
               
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"contacts", "[", 
                   RowBox[{"[", "nBlockUL", "]"}], "]"}], "==", "3"}], ",", 
                 "\n", 
                 RowBox[{
                  RowBox[{"Ns", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUL", ",", "9"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Ts", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUL", ",", "10"}], "]"}], "]"}]}], ";"}], 
                 ",", "\n", 
                 RowBox[{
                  RowBox[{"Ns", "=", "0"}], ";", 
                  RowBox[{"Ts", "=", "0"}], ";"}]}], "\n", "]"}], ";", "\n", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"EvenQ", "[", "nRow", "]"}], ",", "\n", 
                 RowBox[{
                  RowBox[{"Nd", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUR", ",", "9"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Td", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUR", ",", "10"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Ncd", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUR", ",", "7"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Tcd", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUR", ",", "8"}], "]"}], "]"}]}], ";"}], 
                 ",", "\n", 
                 RowBox[{
                  RowBox[{"Nd", "=", "0"}], ";", 
                  RowBox[{"Td", "=", "0"}], ";", 
                  RowBox[{"Ncd", "=", "0"}], ";", 
                  RowBox[{"Tcd", "=", "0"}], ";"}]}], "\n", "]"}], ";"}]}], 
             "\n", "]"}], ";"}]}], "\n", "]"}], ";", "\n", 
         RowBox[{"pvnew", "=", 
          RowBox[{"{", 
           RowBox[{"Ns", ",", "Ts", ",", 
            RowBox[{"Ncs", "+", "Ncd"}], ",", 
            RowBox[{"Tcs", "+", "Tcd"}], ",", "Nd", ",", "Td", ",", "0", ",", 
            "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}], ";"}]}], 
       RowBox[{"(*", 
        RowBox[{"TODO", ":", " ", 
         RowBox[{"modify", " ", "to", " ", "support", " ", "edge", " ", 
          RowBox[{"blocks", "!"}]}]}], "*)"}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"\[Sigma]h", "[", 
         RowBox[{"[", "nBlock", "]"}], "]"}], ",", "pvnew", ",", 
        RowBox[{"\[Sigma]h", "[", 
         RowBox[{"[", 
          RowBox[{"nBlock", "+", "1"}], "]"}], "]"}]}], "]"}]}]}], "\n", 
    "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveRow", "[", "nRow_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "j", ",", "blockSequence", ",", "directions", ",", "blockLoads", ",", 
       "contact"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"blockSequence", "=", 
       RowBox[{"findSolvableBlockSequence", "[", "nRow", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", 
          RowBox[{"blockSequence", "[", "\"\<seq\>\"", "]"}], "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"blockLoads", "=", 
             RowBox[{"getBlockLoads", "[", 
              RowBox[{"{", 
               RowBox[{"nRow", ",", "k"}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"contact", "=", 
             RowBox[{"contacts", "[", 
              RowBox[{"[", 
               RowBox[{"getBlockNum", "[", 
                RowBox[{"{", 
                 RowBox[{"nRow", ",", "k"}], "}"}], "]"}], "]"}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"blockLoads", "=", 
             RowBox[{"solveBlock", "[", 
              RowBox[{"blockLoads", ",", "contact", ",", 
               RowBox[{
                RowBox[{"blockSequence", "[", "\"\<dir\>\"", "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"updateStress", "[", 
             RowBox[{"blockLoads", ",", 
              RowBox[{"{", 
               RowBox[{"nRow", ",", "k"}], "}"}]}], "]"}], ";"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{
              RowBox[{"blockSequence", "[", "\"\<seq\>\"", "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"TODO", ":", " ", 
      RowBox[{
      "check", " ", "equilibrium", " ", "at", " ", "the", " ", "vertical", 
       " ", "interfaces"}]}], "*)"}], "\n", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681836883894326*^9, 3.68183692839038*^9}, {
   3.6819031551956387`*^9, 3.6819032036034307`*^9}, 3.6819032512025833`*^9, {
   3.681906556785943*^9, 3.6819065885856457`*^9}, {3.681906642200575*^9, 
   3.681906674098689*^9}, {3.6819068250771637`*^9, 3.6819068554320393`*^9}, {
   3.681906998126892*^9, 3.681907004182775*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"updateStress", "[", 
    RowBox[{"pBlock_", ",", 
     RowBox[{"{", 
      RowBox[{"nRow_", ",", "j_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "blockNum", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"blockNum", "=", 
       RowBox[{"getBlockNum", "[", 
        RowBox[{"{", 
         RowBox[{"nRow", ",", "j"}], "}"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"\[Sigma]v", "[", 
        RowBox[{"[", "blockNum", "]"}], "]"}], "=", 
       RowBox[{"pBlock", "[", 
        RowBox[{"[", 
         RowBox[{"5", ";;", "16"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"\[Sigma]h", "[", 
        RowBox[{"[", 
         RowBox[{"blockNum", "+", "nRow", "-", "1"}], "]"}], "]"}], "=", 
       RowBox[{"pBlock", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "interface", " ", "on", " ", "the", " ", "left", " ", "side", " ", 
        "of", " ", "the", " ", "current", " ", "block"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"\[Sigma]h", "[", 
        RowBox[{"[", 
         RowBox[{"blockNum", "+", "nRow"}], "]"}], "]"}], "=", 
       RowBox[{"pBlock", "[", 
        RowBox[{"[", 
         RowBox[{"17", ";;", "20"}], "]"}], "]"}]}], ";"}]}], 
    RowBox[{"(*", 
     RowBox[{
     "interface", " ", "on", " ", "the", " ", "right", " ", "side", " ", "of",
       " ", "the", " ", "current", " ", "block"}], "*)"}], "\n", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.681810022813951*^9, 3.681810064630859*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkRowEquilibrium", "[", "pBlock_", "]"}], ":=", 
   RowBox[{
    RowBox[{"pBlock", "[", 
     RowBox[{"[", 
      RowBox[{"17", ";;", "20"}], "]"}], "]"}], "==", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"transferContactActionsBelow", "[", "nRow_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "totalBlocksInRowBelow"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", 
         RowBox[{"nRow", "+", "1"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"totalBlocksInRowBelow", "=", 
          RowBox[{"nelx", "-", "1"}]}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"totalBlocksInRowBelow", "=", "nelx"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "transfer", " ", "base", " ", "reactions", " ", "of", " ", "blocks", 
         " ", "in", " ", "row", " ", "nRow", " ", "to", " ", "the", " ", 
         "blocks", " ", "in", " ", "row", " ", "nRow"}], "+", "1"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "\[LessEqual]", "totalBlocksInRowBelow"}], ",", 
        RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"updateStress", "[", 
          RowBox[{
           RowBox[{"getBlockLoads", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nRow", "+", "1"}], ",", "j"}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"nRow", "+", "1"}], ",", "j"}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\n", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681811104956596*^9, 3.681811152365467*^9}, {
   3.681811239418646*^9, 3.681811327661327*^9}, {3.681811359269311*^9, 
   3.6818114046991987`*^9}, {3.681811447387339*^9, 3.6818115255039473`*^9}, {
   3.681811776504512*^9, 3.681811883908958*^9}, {3.6818124368317833`*^9, 
   3.6818125051648293`*^9}, {3.681812803273199*^9, 3.681812819007867*^9}, {
   3.6818128799656067`*^9, 3.68181288681713*^9}, 3.681812924306329*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveWall", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"eqCheck", "=", "True"}], ";", "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{
         RowBox[{"i", "<=", "nely"}], "&&", "eqCheck"}], ",", 
        RowBox[{"i", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"solveRow", "[", "i", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "!=", "nely"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"transferContactActionsBelow", "[", "i", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\n", "]"}], ";"}]}], "\n", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681811043464787*^9, 3.6818110961396303`*^9}, {
  3.6818128465922422`*^9, 3.681812863230266*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"displayWall", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "blocks", ",", "stressAvg", ",", "interfaces", ",", "frictionRatio", 
       ",", "blockLoads", ",", "ptBL", ",", "ptBR", ",", "ptTR", ",", "i", 
       ",", "j", ",", "totalBlocksInRow"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"blocks", "=", 
       RowBox[{"{", "}"}]}], ";", " ", 
      RowBox[{"stressAvg", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"interfaces", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", "nely"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"EvenQ", "[", "i", "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"totalBlocksInRow", "=", 
             RowBox[{"nelx", "-", "1"}]}], ";"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{
            RowBox[{"totalBlocksInRow", "=", "nelx"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "\[LessEqual]", "totalBlocksInRow"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"isBlockOnLeftEdge", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j"}], "}"}], "]"}], "||", 
                 RowBox[{"isBlockOnRightEdge", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j"}], "}"}], "]"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ptBL", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", " ", "-", "1"}], ")"}], "b"}], "-", 
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], 
                    RowBox[{"b", "/", "2"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"nely", "-", "i"}], ")"}], "h"}]}], "}"}]}], ";", 
               
               RowBox[{"(*", 
                RowBox[{"bottom", " ", "left", " ", 
                 RowBox[{"vertex", "'"}], "s", " ", "coordinates", " ", "of", 
                 " ", "the", " ", "current", " ", "block"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"ptBR", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"j", " ", "b"}], "-", 
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], 
                    RowBox[{"b", "/", "2"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"nely", "-", "i"}], ")"}], "h"}]}], "}"}]}], ";", 
               
               RowBox[{"(*", 
                RowBox[{"bottom", " ", "right", " ", 
                 RowBox[{"vertex", "'"}], "s", " ", "coordinates", " ", "of", 
                 " ", "the", " ", "current", " ", "block"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"ptTR", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"j", " ", "b"}], "-", 
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], 
                    RowBox[{"b", "/", "2"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"nely", "-", "i", "+", "1"}], ")"}], "h"}]}], 
                 "}"}]}], ";"}], 
              RowBox[{"(*", 
               RowBox[{"top", " ", "right", " ", 
                RowBox[{"vertex", "'"}], "s", " ", "coordinates", " ", "of", 
                " ", "the", " ", "current", " ", "block"}], "*)"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"isBlockOnLeftEdge", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j"}], "}"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "block", " ", "on", " ", "the", " ", "left", " ", "edge"}], 
                  "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ptBL", "=", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nely", "-", "i"}], ")"}], "h"}]}], "}"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ptBR", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b", "-", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], 
                    RowBox[{"b", "/", "2"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nely", "-", "i"}], ")"}], "h"}]}], "}"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ptTR", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b", "-", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], 
                    RowBox[{"b", "/", "2"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nely", "-", "i", "+", "1"}], ")"}], "h"}]}], 
                    "}"}]}], ";"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                  "block", " ", "on", " ", "the", " ", "right", " ", "edge"}],
                   "*)"}], "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ptBL", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", 
                    RowBox[{"(", 
                    RowBox[{"nelx", "-", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], 
                    RowBox[{"b", "/", "2"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nely", "-", "i"}], ")"}], "h"}]}], "}"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ptBR", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b", 
                    RowBox[{"(", 
                    RowBox[{"nelx", "-", "1"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nely", "-", "i"}], ")"}], "h"}]}], "}"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"ptTR", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b", " ", 
                    RowBox[{"(", 
                    RowBox[{"nelx", "-", "1"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nely", "-", "i", "+", "1"}], ")"}], "h"}]}], 
                    "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "create", " ", "graphical", " ", "elements", " ", "colored", " ",
               "using", " ", "stress", " ", "measure"}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"blockLoads", "=", 
             RowBox[{"getBlockLoads", "[", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"stressAvg", ",", 
              RowBox[{"Norm", "[", "blockLoads", "]"}]}], "]"}], ";", 
            RowBox[{"(*", 
             RowBox[{
             "stress", " ", "measure", " ", "defined", " ", "as", " ", "the", 
              " ", "norm", " ", 
              RowBox[{"of", " ", "'"}], 
              RowBox[{"blockLoads", "'"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"blocks", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", 
                 RowBox[{"{", "Black", "}"}], "]"}], ",", 
                RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{"ptBL", ",", "ptTR"}], "]"}]}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
            RowBox[{"frictionRatio", "=", 
             RowBox[{"Piecewise", "[", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"Total", "[", 
                    RowBox[{"blockLoads", "[", 
                    RowBox[{"[", 
                    RowBox[{"12", ";;", "16", ";;", "2"}], "]"}], "]"}], 
                    "]"}], "]"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"\[Mu]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"blockLoads", "[", 
                    RowBox[{"[", 
                    RowBox[{"11", ";;", "15", ";;", "2"}], "]"}], "]"}], 
                    "]"}]}], ")"}]}], ",", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"blockLoads", "[", 
                    RowBox[{"[", 
                    RowBox[{"11", ";;", "15", ";;", "2"}], "]"}], "]"}], 
                   "]"}], ">", "0"}]}], "}"}], "}"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"interfaces", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"RGBColor", "[", 
                 RowBox[{"frictionRatio", ",", "0", ",", "0"}], "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{"ptBL", ",", "ptBR"}], "}"}], "]"}]}], "}"}]}], 
             "]"}], ";"}]}], 
          RowBox[{"(*", 
           RowBox[{"friction", " ", "on", " ", "the", " ", "base"}], "*)"}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\n", 
      RowBox[{
       RowBox[{"blocks", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"GrayLevel", "/@", 
        RowBox[{"(", 
         RowBox[{"stressAvg", "/", 
          RowBox[{"Max", "[", "stressAvg", "]"}]}], ")"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "assign", " ", "GrayLevel", " ", "based", " ", "on", " ", "strees"}], 
       "*)"}], "\n", "\n", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Graphics", "[", "blocks", "]"}], ",", 
        RowBox[{"Graphics", "[", "interfaces", "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.681816733903646*^9, 3.681816842442526*^9}, {
   3.681816962631504*^9, 3.681817034853053*^9}, {3.681817272945464*^9, 
   3.6818173603401327`*^9}, {3.681817492858342*^9, 3.681817559149295*^9}, {
   3.681817636030326*^9, 3.68181764631828*^9}, {3.681817683828524*^9, 
   3.681817750005192*^9}, {3.681819178447322*^9, 3.681819214886211*^9}, {
   3.6818192534099293`*^9, 3.681819255070256*^9}, {3.681819293637179*^9, 
   3.6818193378925467`*^9}, {3.681819499489346*^9, 3.6818195173255587`*^9}, {
   3.681819648682395*^9, 3.681819698323799*^9}, 3.681819736028159*^9, {
   3.681819804752611*^9, 3.681819868400968*^9}, {3.681819990317973*^9, 
   3.681820012098566*^9}, {3.6818200458064737`*^9, 3.681820156780024*^9}, {
   3.6818203379737473`*^9, 3.681820371416211*^9}, {3.6818207757731237`*^9, 
   3.681820882847082*^9}, {3.681821072615365*^9, 3.681821087364579*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem\[CloseCurlyQuote]s stuff", "Section",
 CellChangeTimes->{{3.681800742754244*^9, 3.6818007465997057`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"initStressVectors", "[", 
    RowBox[{"$nelx_", ",", "$nely_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "$nely", "]"}], ",", "\n", 
        RowBox[{
         RowBox[{"totalBlocks", "=", 
          RowBox[{"getBlockNum", "[", 
           RowBox[{"{", 
            RowBox[{"$nely", ",", 
             RowBox[{"$nelx", "-", "1"}]}], "}"}], "]"}]}], ";"}], ",", "\n", 
        
        RowBox[{
         RowBox[{"totalBlocks", "=", 
          RowBox[{"getBlockNum", "[", 
           RowBox[{"{", 
            RowBox[{"$nely", ",", "$nelx"}], "}"}], "]"}]}], ";"}]}], "\n", 
       "]"}], ";", "\n", 
      RowBox[{"\[Sigma]v", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "totalBlocks", "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"\[Sigma]h", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"totalBlocks", "+", "$nely"}], "}"}]}], "]"}]}], ";"}]}], 
    "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setProblemProperties", "[", 
    RowBox[{
    "$nelx_", ",", "$nely_", ",", "$b_", ",", "$h_", ",", "$P_", ",", 
     "$\[Mu]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"nelx", "=", "$nelx"}], ";", 
      RowBox[{"nely", "=", "$nely"}], ";", "\n", 
      RowBox[{"b", "=", "$b"}], ";", 
      RowBox[{"h", "=", "$h"}], ";", "\n", 
      RowBox[{"P", "=", "$P"}], ";", 
      RowBox[{"\[Mu]", "=", "$\[Mu]"}], ";", "\n", 
      RowBox[{"initStressVectors", "[", 
       RowBox[{"nelx", ",", "nely"}], "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.681806121974045*^9, 3.6818061450677567`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generateContacts", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"contacts", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}], ",", "totalBlocks"}], "]"}]}], 
      ";"}]}], "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setBoundaryConditions", "[", "$loads_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"loads", "=", "$loads"}], ";"}]}], "\n", "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"applyLoads", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "j", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", "nelx"}], ",", 
        RowBox[{"j", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Sigma]v", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"loads", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"6", 
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
               RowBox[{"6", "j"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
             "}"}]}], "]"}]}], ";"}]}], "\n", "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6817996946494837`*^9, 3.6817997062915993`*^9}, {
  3.681799743659074*^9, 3.6817997438131447`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveProblem", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"applyLoads", "[", "]"}], ";", "\n", 
      RowBox[{"solveWall", "[", "]"}], ";", "\n", 
      RowBox[{"displayWall", "[", "]"}]}]}], "\n", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.681799554317299*^9, 3.6818008047174587`*^9, 3.681805869677287*^9, {
   3.681820534282044*^9, 3.6818205375864897`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Section",
 CellChangeTimes->{{3.68180082612658*^9, 3.681800827648224*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Properties", " ", "initialization"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"nelx", "=", "40"}], ";", 
    RowBox[{"nely", "=", "20"}], ";", 
    RowBox[{"b", "=", "2"}], ";", 
    RowBox[{"h", "=", "1"}], ";", 
    RowBox[{"P", "=", "0.1"}], ";", 
    RowBox[{"\[Mu]", "=", "0.8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setProblemProperties", "[", 
     RowBox[{
     "nelx", ",", "nely", ",", "b", ",", "h", ",", "P", ",", "\[Mu]"}], "]"}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.681800897819695*^9, 3.681800925859068*^9}, {
  3.6818061755977163`*^9, 3.681806198491375*^9}, {3.681807249128894*^9, 
  3.681807252358502*^9}, {3.681820919595581*^9, 3.6818209238880463`*^9}, {
  3.681834187131278*^9, 3.681834192198721*^9}, {3.681837748710472*^9, 
  3.6818377587953987`*^9}, {3.681887377599655*^9, 3.68188738539964*^9}, {
  3.681907207986231*^9, 3.681907211109733*^9}, {3.6819072904716043`*^9, 
  3.681907318492744*^9}, {3.68190737181026*^9, 3.6819073739948874`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Contacts", " ", "generation"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"generateContacts", "[", "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.681806202871662*^9, 3.681806247462635*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Loads", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0.2", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", "nelx", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "10", ",", "9", ",", "0", ",", "0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"[", "20", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "10", ",", "5", ",", "0", ",", "0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"[", "35", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "10", ",", 
       RowBox[{"-", "5"}], ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"Flatten", "[", "p", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setBoundaryConditions", "[", "p", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6818009687794867`*^9, 3.681800979448945*^9}, {
   3.6818209671377068`*^9, 3.6818209960043983`*^9}, 3.681837178889175*^9, 
   3.6818374667603807`*^9, {3.681837686824499*^9, 3.681837687774103*^9}, {
   3.6818873972149973`*^9, 3.681887429524086*^9}, {3.681887749187104*^9, 
   3.681887753782529*^9}, {3.681887834659442*^9, 3.6818878786849947`*^9}, {
   3.681888068135314*^9, 3.681888115918132*^9}, {3.68188819101409*^9, 
   3.6818882060660963`*^9}, {3.6818882730128403`*^9, 
   3.6818883016188927`*^9}, {3.6818884832154408`*^9, 3.681888489160434*^9}, 
   3.681888544444072*^9, {3.681888688040085*^9, 3.681888691449609*^9}, {
   3.68188874790994*^9, 3.6818887498530273`*^9}, {3.681889133194478*^9, 
   3.6818891359854507`*^9}, {3.68188922280212*^9, 3.681889245627615*^9}, {
   3.681889311016531*^9, 3.681889387720848*^9}, 3.681889482262664*^9, 
   3.6818899527251*^9, 3.6818900546432533`*^9, 3.68189009240012*^9, 
   3.681890128978732*^9, {3.681890181382146*^9, 3.681890182929777*^9}, 
   3.6818903251845493`*^9, 3.6818904871063766`*^9, 3.681900633297118*^9, {
   3.681901080852096*^9, 3.681901085298888*^9}, 3.681901134165181*^9, 
   3.6819024493535147`*^9, {3.681902489674528*^9, 3.681902498194981*^9}, {
   3.681902542297921*^9, 3.6819025961872797`*^9}, {3.681902641126587*^9, 
   3.681902659215238*^9}, {3.6819032762766237`*^9, 3.6819032774648657`*^9}, 
   3.681903370335958*^9, 3.6819040617848663`*^9, {3.681906192867955*^9, 
   3.6819062082954206`*^9}, {3.681907180186204*^9, 3.681907284318181*^9}, {
   3.681907337372348*^9, 3.681907359370723*^9}, {3.681907401993403*^9, 
   3.681907472290341*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Solution", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"solveProblem", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.681800985789946*^9, 3.681801028265375*^9}, 
   3.681813056006426*^9, 3.681820561835126*^9}]
}, Open  ]]
},
WindowSize->{1366, 744},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 117, 1, 65, "Section"],
Cell[700, 25, 691, 22, 32, "Input"],
Cell[1394, 49, 3476, 96, 297, "Input"],
Cell[4873, 147, 6543, 173, 693, "Input"],
Cell[11419, 322, 421, 12, 77, "Input"],
Cell[11843, 336, 599, 16, 121, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12479, 357, 116, 1, 65, "Section"],
Cell[12598, 360, 2077, 64, 363, "Input"],
Cell[14678, 426, 4466, 103, 429, "Input"],
Cell[19147, 531, 12849, 305, 1463, "Input"],
Cell[31999, 838, 2802, 65, 319, "Input"],
Cell[34804, 905, 1614, 44, 143, "Input"],
Cell[36421, 951, 308, 9, 32, "Input"],
Cell[36732, 962, 2095, 48, 231, "Input"],
Cell[38830, 1012, 962, 25, 209, "Input"],
Cell[39795, 1039, 12628, 291, 825, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52460, 1335, 119, 1, 65, "Section"],
Cell[52582, 1338, 1428, 40, 187, "Input"],
Cell[54013, 1380, 746, 20, 143, "Input"],
Cell[54762, 1402, 406, 13, 77, "Input"],
Cell[55171, 1417, 275, 9, 77, "Input"],
Cell[55449, 1428, 1134, 32, 121, "Input"],
Cell[56586, 1462, 494, 13, 121, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57117, 1480, 91, 1, 65, "Section"],
Cell[57211, 1483, 1058, 23, 77, "Input"],
Cell[58272, 1508, 255, 6, 55, "Input"],
Cell[58530, 1516, 2899, 61, 165, "Input"],
Cell[61432, 1579, 247, 5, 55, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
