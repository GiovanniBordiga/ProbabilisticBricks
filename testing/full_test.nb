(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    184727,       4678]
NotebookOptionsPosition[    178826,       4494]
NotebookOutlinePosition[    179162,       4509]
CellTagsIndexPosition[    179119,       4506]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Block\[CloseCurlyQuote]s stuff", "Section",
 CellChangeTimes->{{3.681800479513413*^9, 3.6818004874447823`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"switchLR", "[", "p_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "pnew", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"pnew", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", "20", "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{"switch", " ", "normal", " ", "forces"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"p", "[", 
        RowBox[{"[", 
         RowBox[{"17", ";;", "20", ";;", "2"}], "]"}], "]"}]}], ";", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"17", ";;", "20", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"p", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4", ";;", "2"}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Ls", "\[UndirectedEdge]", "Ld"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"5", ";;", "9", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"p", "[", 
        RowBox[{"[", 
         RowBox[{"9", ";;", "5", ";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Ns", "\[UndirectedEdge]", "Nc", "\[UndirectedEdge]", "Nd"}], 
       "*)"}], "\n", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"11", ";;", "15", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"p", "[", 
        RowBox[{"[", 
         RowBox[{"15", ";;", "11", ";;", 
          RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Rs", "\[UndirectedEdge]", "Rc", "\[UndirectedEdge]", "Rd"}], 
       "*)"}], "\n", 
      RowBox[{"(*", 
       RowBox[{"switch", " ", "tangential", " ", "forces"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", "4", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"p", "[", 
         RowBox[{"[", 
          RowBox[{"18", ";;", "20", ";;", "2"}], "]"}], "]"}]}]}], ";", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"18", ";;", "20", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"p", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;", "4", ";;", "2"}], "]"}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Vsu", "\[UndirectedEdge]", "Vdu"}], ",", 
        RowBox[{"Vsb", "\[UndirectedEdge]", "Vdb"}]}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"6", ";;", "10", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"p", "[", 
         RowBox[{"[", 
          RowBox[{"10", ";;", "6", ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Ts", "\[UndirectedEdge]", "Td"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"pnew", "[", 
        RowBox[{"[", 
         RowBox[{"12", ";;", "16", ";;", "2"}], "]"}], "]"}], "=", 
       RowBox[{"-", 
        RowBox[{"p", "[", 
         RowBox[{"[", 
          RowBox[{"16", ";;", "12", ";;", 
           RowBox[{"-", "2"}]}], "]"}], "]"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{"Vs", "\[UndirectedEdge]", "Vc", "\[UndirectedEdge]", "Vd"}], 
       "*)"}], "\n", "\n", "pnew"}]}], "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", 
    RowBox[{"H_", ",", "Rt_", ",", "\[Mu]_", ",", "R_"}], "]"}], ":=", 
   RowBox[{"Piecewise", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"R", "/", "Rt"}], " ", "H"}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", "H", "]"}], "<=", 
         RowBox[{"\[Mu]", " ", "Rt"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sign", "[", "H", "]"}], "\[Mu]", " ", "R"}], ",", 
        RowBox[{
         RowBox[{"Abs", "[", "H", "]"}], ">", 
         RowBox[{"\[Mu]", " ", "Rt"}]}]}], "}"}]}], "}"}], "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveBlockL2R", "[", 
    RowBox[{"pBlock_", ",", "contact_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
       "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", "Rc",
        ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", "Ldb", 
       ",", "Vdb", ",", "Ms", ",", "Mc", ",", "Md", ",", "H", ",", "Rt"}], 
      "}"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
         "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", 
         "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", 
         "Ldb", ",", "Vdb"}], "}"}], "=", "pBlock"}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"solution", " ", "left", " ", "to", " ", "right"}], "*)"}], 
      "\n", 
      RowBox[{"Ldu", "=", "0"}], ";", 
      RowBox[{"Vdu", "=", "0"}], ";", 
      RowBox[{"Ldb", "=", "0"}], ";", 
      RowBox[{"Vdb", "=", "0"}], ";", "\n", 
      RowBox[{"Md", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ns", "+", "Vsu", "+", "Vsb", "+", 
           RowBox[{"Nc", "/", "2"}], "+", 
           RowBox[{"P", "/", "2"}]}], ")"}], "b"}], "-", 
        RowBox[{"h", 
         RowBox[{"(", 
          RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
          ")"}]}]}]}], ";", "\n", 
      RowBox[{"Ms", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Nc", "/", "2"}], "+", 
           RowBox[{"P", "/", "2"}], "+", "Nd", "-", "Vdu", "-", "Vdb"}], 
          ")"}], "b"}], "+", 
        RowBox[{"h", 
         RowBox[{"(", 
          RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
          ")"}]}]}]}], ";", "\n", 
      RowBox[{"Mc", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "Ns", "+", "Vsu", "+", "Vsb", "-", "Nd", "+", "Vdu", "+", "Vdb"}], 
          ")"}], 
         RowBox[{"b", "/", "2"}]}], "-", 
        RowBox[{"h", 
         RowBox[{"(", 
          RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
          ")"}]}]}]}], ";", "\n", 
      RowBox[{"Rt", "=", 
       RowBox[{
       "Vsu", "+", "Vsb", "+", "Ns", "+", "Nc", "+", "P", "+", "Nd", "-", 
        "Vdu", "-", "Vdb"}]}], ";", "\n", 
      RowBox[{"H", "=", 
       RowBox[{
       "Lsu", "+", "Lsb", "+", "Ts", "+", "Tc", "+", "Td", "-", "Ldu", "-", 
        "Ldb"}]}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"contact", "==", "1"}], ",", "\n", 
        RowBox[{"(*", 
         RowBox[{"meccanismo", " ", "1"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"Rc", "=", "0"}], ";", "\n", 
         RowBox[{"Rs", "=", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Md", "/", "b"}], ",", "0"}], "]"}]}], ";", "\n", 
         RowBox[{"Rd", "=", 
          RowBox[{"Rt", "-", "Rs"}]}], ";"}], ",", "\n", 
        RowBox[{"(*", 
         RowBox[{"meccanismo", " ", "2", " ", "e", " ", "3"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"Rs", "=", 
          RowBox[{"Max", "[", 
           RowBox[{
            RowBox[{"Mc", "/", 
             RowBox[{"(", 
              RowBox[{"b", "/", "2"}], ")"}]}], ",", "0"}], "]"}]}], ";", 
         "\n", 
         RowBox[{"Rd", "=", 
          RowBox[{"Piecewise", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "Mc"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"b", "/", "2"}], ")"}]}], ",", "0"}], "]"}], ",", 
               RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Rt", ",", 
               RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
         RowBox[{"Rc", "=", 
          RowBox[{"Piecewise", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"Rt", "-", "Rs", "-", "Rd"}], ",", "0"}], "]"}], ",", 
               RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";"}]}], 
       "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"Ldu", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Md"}], "/", "h"}], ",", "0"}], "]"}]}], ";", "\n", 
      RowBox[{"Vs", "=", 
       RowBox[{"V", "[", 
        RowBox[{"H", ",", "Rt", ",", "\[Mu]", ",", "Rs"}], "]"}]}], ";", "\n", 
      RowBox[{"Vc", "=", 
       RowBox[{"V", "[", 
        RowBox[{"H", ",", "Rt", ",", "\[Mu]", ",", "Rc"}], "]"}]}], ";", "\n", 
      RowBox[{"Vd", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"H", ",", "Rt", ",", "\[Mu]", ",", "Rd"}], "]"}], ",", 
            RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"H", "-", "Ldu"}], ",", 
              RowBox[{"\[Mu]", " ", "Rd"}]}], "]"}], ",", 
            RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
      RowBox[{"Ldb", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"H", "-", 
               RowBox[{"\[Mu]", " ", "Rt"}]}], ",", "0"}], "]"}], ",", 
            RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"H", "-", "Ldu", "-", "Vd"}], ",", 
            RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"{", 
       RowBox[{
       "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
        "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", 
        "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", 
        "Ldb", ",", "Vdb"}], "}"}]}]}], "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveHalvedBlockL2R", "[", 
    RowBox[{"pBlock_", ",", "isOnLeftEdge_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
       "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", "Rc",
        ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", "Ldb", 
       ",", "Vdb", ",", "Ms", ",", "Mc", ",", "Md", ",", "H", ",", "Rt"}], 
      "}"}], ",", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
         "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", 
         "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", 
         "Ldb", ",", "Vdb"}], "}"}], "=", "pBlock"}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"solution", " ", "left", " ", "to", " ", "right"}], "*)"}], 
      "\n", 
      RowBox[{"Ldu", "=", "0"}], ";", 
      RowBox[{"Vdu", "=", "0"}], ";", 
      RowBox[{"Ldb", "=", "0"}], ";", 
      RowBox[{"Vdb", "=", "0"}], ";", "\n", 
      RowBox[{"Rt", "=", 
       RowBox[{"Vsu", "+", "Vsb", "+", "Ns", "+", "Nc", "+", 
        RowBox[{"P", "/", "2"}], "+", "Nd", "-", "Vdu", "-", "Vdb"}]}], ";", 
      "\n", 
      RowBox[{"H", "=", 
       RowBox[{
       "Lsu", "+", "Lsb", "+", "Ts", "+", "Tc", "+", "Td", "-", "Ldu", "-", 
        "Ldb"}]}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "modify", " ", "resultants", " ", "for", " ", "the", " ", "halved", 
        " ", "block"}], "*)"}], "\n", 
      RowBox[{"If", "[", 
       RowBox[{"isOnLeftEdge", ",", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "halved", " ", "block", " ", "on", " ", "the", " ", "left", " ", 
          "edge"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"Md", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Ns", "+", "Vsu", "+", "Vsb", "+", 
              RowBox[{"Nc", "/", "2"}], "+", 
              RowBox[{
               RowBox[{"P", "/", "2"}], "/", "4"}]}], ")"}], "b"}], "-", 
           RowBox[{"h", 
            RowBox[{"(", 
             RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
             ")"}]}]}]}], ";", "\n", 
         RowBox[{"Mc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
             "Ns", "+", "Vsu", "+", "Vsb", "-", "Nd", "+", "Vdu", "+", 
              "Vdb"}], ")"}], 
            RowBox[{"b", "/", "2"}]}], "-", 
           RowBox[{"h", 
            RowBox[{"(", 
             RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
             ")"}]}], "-", 
           RowBox[{
            RowBox[{"P", "/", "2"}], 
            RowBox[{"b", "/", "4"}]}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "compute", " ", "reactions", " ", "for", " ", "the", " ", "halved",
             " ", "block"}], " ", "-", " ", 
           RowBox[{"only", " ", "one", " ", "mechanism"}]}], "*)"}], "\n", 
         RowBox[{"Rs", "=", "0"}], ";", "\n", 
         RowBox[{"Rd", "=", 
          RowBox[{"Piecewise", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "Mc"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"b", "/", "2"}], ")"}]}], ",", "0"}], "]"}], ",", 
               RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Rt", ",", 
               RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
         RowBox[{"Rc", "=", 
          RowBox[{"Piecewise", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"Rt", "-", "Rs", "-", "Rd"}], ",", "0"}], "]"}], ",", 
               RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";"}], 
        ",", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "halved", " ", "block", " ", "on", " ", "the", " ", "right", " ", 
          "edge"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"Ms", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Nc", "/", "2"}], "+", 
              RowBox[{
               RowBox[{"P", "/", "2"}], "/", "4"}], "+", "Nd", "-", "Vdu", 
              "-", "Vdb"}], ")"}], "b"}], "+", 
           RowBox[{"h", 
            RowBox[{"(", 
             RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
             ")"}]}]}]}], ";", "\n", 
         RowBox[{"Md", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
             "Ns", "+", "Vsu", "+", "Vsb", "-", "Nd", "+", "Vdu", "+", 
              "Vdb"}], ")"}], 
            RowBox[{"b", "/", "2"}]}], "-", 
           RowBox[{"h", 
            RowBox[{"(", 
             RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
             ")"}]}], "+", 
           RowBox[{
            RowBox[{"P", "/", "2"}], 
            RowBox[{"b", "/", "4"}]}]}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "compute", " ", "reactions", " ", "for", " ", "the", " ", "halved",
             " ", "block"}], " ", "-", " ", 
           RowBox[{"only", " ", "one", " ", "mechanism"}]}], "*)"}], "\n", 
         RowBox[{"Rd", "=", "0"}], ";", "\n", 
         RowBox[{"Rc", "=", 
          RowBox[{"Piecewise", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"Ms", "/", 
                  RowBox[{"(", 
                   RowBox[{"b", "/", "2"}], ")"}]}], ",", "0"}], "]"}], ",", 
               RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Rt", ",", 
               RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
         RowBox[{"Rs", "=", 
          RowBox[{"Piecewise", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Max", "[", 
                RowBox[{
                 RowBox[{"Rt", "-", "Rc", "-", "Rd"}], ",", "0"}], "]"}], ",", 
               RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";"}]}], 
       "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"Ldu", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Md"}], "/", "h"}], ",", "0"}], "]"}]}], ";", "\n", 
      RowBox[{"Vs", "=", 
       RowBox[{"V", "[", 
        RowBox[{"H", ",", "Rt", ",", "\[Mu]", ",", "Rs"}], "]"}]}], ";", "\n", 
      RowBox[{"Vc", "=", 
       RowBox[{"V", "[", 
        RowBox[{"H", ",", "Rt", ",", "\[Mu]", ",", "Rc"}], "]"}]}], ";", "\n", 
      RowBox[{"Vd", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"V", "[", 
             RowBox[{"H", ",", "Rt", ",", "\[Mu]", ",", "Rd"}], "]"}], ",", 
            RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"H", "-", "Ldu"}], ",", 
              RowBox[{"\[Mu]", " ", "Rd"}]}], "]"}], ",", 
            RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
      RowBox[{"Ldb", "=", 
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{
              RowBox[{"H", "-", 
               RowBox[{"\[Mu]", " ", "Rt"}]}], ",", "0"}], "]"}], ",", 
            RowBox[{"Md", ">=", "0"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"H", "-", "Ldu", "-", "Vd"}], ",", 
            RowBox[{"Md", "<", "0"}]}], "}"}]}], "}"}], "]"}]}], ";", "\n", 
      "\n", 
      RowBox[{"{", 
       RowBox[{
       "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
        "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", 
        "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", 
        "Ldb", ",", "Vdb"}], "}"}]}]}], "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"solveBlockR2L", "[", 
     RowBox[{"pBlock_", ",", "contact_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\n", 
      RowBox[{"switchLR", "[", 
       RowBox[{"solveBlockL2R", "[", 
        RowBox[{
         RowBox[{"switchLR", "[", "pBlock", "]"}], ",", "contact"}], "]"}], 
       "]"}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"solveHalvedBlockR2L", "[", 
    RowBox[{"pBlock_", ",", "isOnLeftEdge_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{"switchLR", "[", 
      RowBox[{"solveHalvedBlockL2R", "[", 
       RowBox[{
        RowBox[{"switchLR", "[", "pBlock", "]"}], ",", 
        RowBox[{"!", "isOnLeftEdge"}]}], "]"}], "]"}]}], "\n", "]"}]}], 
  ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveBlock", "[", 
    RowBox[{"pBlock_", ",", "contact_", ",", 
     RowBox[{"{", 
      RowBox[{"nRow_", ",", "j_"}], "}"}], ",", "dir_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"isBlockHalved", "[", 
         RowBox[{"{", 
          RowBox[{"nRow", ",", "j"}], "}"}], "]"}]}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{"normal", " ", "blocks"}], "*)"}], "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dir", ">", "0"}], ",", "\n", 
         RowBox[{"solveBlockL2R", "[", 
          RowBox[{"pBlock", ",", "contact"}], "]"}], ",", "\n", 
         RowBox[{"solveBlockR2L", "[", 
          RowBox[{"pBlock", ",", "contact"}], "]"}]}], "\n", "]"}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{"halved", " ", "blocks"}], "*)"}], "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"dir", ">", "0"}], ",", "\n", 
         RowBox[{"solveHalvedBlockL2R", "[", 
          RowBox[{"pBlock", ",", 
           RowBox[{"isBlockOnLeftEdge", "[", 
            RowBox[{"{", 
             RowBox[{"nRow", ",", "j"}], "}"}], "]"}]}], "]"}], ",", "\n", 
         RowBox[{"solveHalvedBlockR2L", "[", 
          RowBox[{"pBlock", ",", 
           RowBox[{"isBlockOnLeftEdge", "[", 
            RowBox[{"{", 
             RowBox[{"nRow", ",", "j"}], "}"}], "]"}]}], "]"}]}], "\n", 
        "]"}]}], "\n", "]"}]}], "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"correctBlock", "[", 
    RowBox[{"pBlock_", ",", "contact_", ",", 
     RowBox[{"{", 
      RowBox[{"nRow_", ",", "j_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
       "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", "Rc",
        ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", "Ldb", 
       ",", "Vdb", ",", "Mc", ",", "Md", ",", "H", ",", "Rt"}], "}"}], ",", 
     "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
         "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", 
         "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", 
         "Ldb", ",", "Vdb"}], "}"}], "=", "pBlock"}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"isBlockHalved", "[", 
         RowBox[{"{", 
          RowBox[{"nRow", ",", "j"}], "}"}], "]"}], ",", "\n", 
        RowBox[{"(*", 
         RowBox[{"halved", " ", "blocks"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"isBlockOnLeftEdge", "[", 
            RowBox[{"{", 
             RowBox[{"nRow", ",", "j"}], "}"}], "]"}], ",", "\n", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts",
                ",", "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", 
               "Vs", ",", "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", 
               ",", "Vdu", ",", "Ldb", ",", "Vdb"}], "}"}], "=", 
             RowBox[{"solveHalvedBlockR2L", "[", 
              RowBox[{"pBlock", ",", "True"}], "]"}]}], ";"}], ",", "\n", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts",
                ",", "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", 
               "Vs", ",", "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", 
               ",", "Vdu", ",", "Ldb", ",", "Vdb"}], "}"}], "=", 
             RowBox[{"solveHalvedBlockL2R", "[", 
              RowBox[{"pBlock", ",", "False"}], "]"}]}], ";"}]}], "\n", "]"}],
          ";"}], ",", "\n", 
        RowBox[{"(*", 
         RowBox[{"normal", " ", "blocks"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"Rt", "=", 
          RowBox[{
          "Vsu", "+", "Vsb", "+", "Ns", "+", "Nc", "+", "P", "+", "Nd", "-", 
           "Vdu", "-", "Vdb"}]}], ";", "\n", 
         RowBox[{"H", "=", 
          RowBox[{
          "Lsu", "+", "Lsb", "+", "Ts", "+", "Tc", "+", "Td", "-", "Ldu", "-",
            "Ldb"}]}], ";", "\n", 
         RowBox[{"Md", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Ns", "+", "Vsu", "+", "Vsb", "+", 
              RowBox[{"Nc", "/", "2"}], "+", 
              RowBox[{"P", "/", "2"}]}], ")"}], "b"}], "-", 
           RowBox[{"h", 
            RowBox[{"(", 
             RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
             ")"}]}]}]}], ";", "\n", 
         RowBox[{"Mc", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
             "Ns", "+", "Vsu", "+", "Vsb", "-", "Nd", "+", "Vdu", "+", 
              "Vdb"}], ")"}], 
            RowBox[{"b", "/", "2"}]}], "-", 
           RowBox[{"h", 
            RowBox[{"(", 
             RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
             ")"}]}]}]}], ";", "\n", "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"Mc", "/", "Rt"}], "]"}], ">", 
            RowBox[{"b", "/", "2"}]}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "no", " ", "base", " ", "mechanism", " ", "is", " ", 
              "possible"}], ",", " ", 
             RowBox[{"solve", " ", "L2R", " ", "or", " ", "R2L"}]}], "*)"}], 
           "\n", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts",
                ",", "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", 
               "Vs", ",", "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", 
               ",", "Vdu", ",", "Ldb", ",", "Vdb"}], "}"}], "=", 
             RowBox[{"solveBlock", "[", 
              RowBox[{"pBlock", ",", "contact", ",", 
               RowBox[{"{", 
                RowBox[{"nRow", ",", "j"}], "}"}], ",", 
               RowBox[{"-", 
                RowBox[{"Sign", "[", 
                 RowBox[{"Mc", "/", "Rt"}], "]"}]}]}], "]"}]}], ";"}], "\n", 
           ",", "\n", 
           RowBox[{"(*", 
            RowBox[{"base", " ", "mechanism", " ", "is", " ", "possible"}], 
            "*)"}], "\n", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"contact", "==", "1"}], ",", "\n", 
              RowBox[{"(*", 
               RowBox[{"meccanismo", " ", "1"}], "*)"}], "\n", 
              RowBox[{
               RowBox[{"Rc", "=", "0"}], ";", "\n", 
               RowBox[{"Rs", "=", 
                RowBox[{"Md", "/", "b"}]}], ";", "\n", 
               RowBox[{"Rd", "=", 
                RowBox[{"Rt", "-", "Rs"}]}], ";"}], ",", "\n", 
              RowBox[{"(*", 
               RowBox[{"meccanismo", " ", "2", " ", "e", " ", "3"}], "*)"}], 
              "\n", 
              RowBox[{
               RowBox[{"Rs", "=", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{"Mc", "/", 
                   RowBox[{"(", 
                    RowBox[{"b", "/", "2"}], ")"}]}], ",", "0"}], "]"}]}], 
               ";", "\n", 
               RowBox[{"Rd", "=", 
                RowBox[{"Max", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "Mc"}], "/", 
                   RowBox[{"(", 
                    RowBox[{"b", "/", "2"}], ")"}]}], ",", "0"}], "]"}]}], 
               ";", "\n", 
               RowBox[{"Rc", "=", 
                RowBox[{"Rt", "-", "Rs", "-", "Rd"}]}], ";"}]}], "\n", "]"}], 
            ";", "\n", 
            RowBox[{"Vs", "=", 
             RowBox[{"V", "[", 
              RowBox[{"H", ",", "Rt", ",", "\[Mu]", ",", "Rs"}], "]"}]}], ";",
             "\n", 
            RowBox[{"Vd", "=", 
             RowBox[{"V", "[", 
              RowBox[{"H", ",", "Rt", ",", "\[Mu]", ",", "Rd"}], "]"}]}], ";",
             "\n", 
            RowBox[{"Vc", "=", 
             RowBox[{"V", "[", 
              RowBox[{"H", ",", "Rt", ",", "\[Mu]", ",", "Rc"}], "]"}]}], ";",
             "\n", 
            RowBox[{"(*", 
             RowBox[{
             "check", " ", "if", " ", "the", " ", "friction", " ", 
              "criterion", " ", "is", " ", "satified"}], "*)"}], "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"H", "-", "Vs", "-", "Vc", "-", "Vd"}], ">", "0"}], 
              ",", "\n", 
              RowBox[{
               RowBox[{"Ldb", "=", 
                RowBox[{"H", "+", "Ldb", "-", "Vs", "-", "Vc", "-", "Vd"}]}], 
               ";"}]}], "\n", "]"}], ";", "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"H", "-", "Vs", "-", "Vc", "-", "Vd"}], "<", "0"}], 
              ",", "\n", 
              RowBox[{
               RowBox[{"Lsb", "=", 
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"H", "-", "Lsb", "-", "Vs", "-", "Vc", "-", "Vd"}], 
                  ")"}]}]}], ";"}]}], "\n", "]"}], ";"}]}], "\n", "]"}], 
         ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"{", 
       RowBox[{
       "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
        "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", 
        "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", 
        "Ldb", ",", "Vdb"}], "}"}]}]}], "\n", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682579497495554*^9, 3.6825795038062267`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Wall\[CloseCurlyQuote]s stuff", "Section",
 CellChangeTimes->{{3.6818006720196657`*^9, 3.681800675352103*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getBlockNum", "[", 
     RowBox[{"{", 
      RowBox[{"nRow_", ",", "j_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "nBlock", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"EvenQ", "[", "nRow", "]"}], ",", "\n", 
         RowBox[{
          RowBox[{"nBlock", "=", 
           RowBox[{
            RowBox[{"nelx", " ", 
             RowBox[{"nRow", "/", "2"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nelx", "-", "1"}], ")"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"nRow", "/", "2"}], "-", "1"}], ")"}]}]}]}], ";"}], 
         ",", "\n", 
         RowBox[{
          RowBox[{"nBlock", "=", 
           RowBox[{
            RowBox[{"nelx", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nRow", "-", "1"}], ")"}], "/", "2"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"nelx", "-", "1"}], ")"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"nRow", "-", "1"}], ")"}], "/", "2"}]}]}]}], ";"}]}], 
        "\n", "]"}], ";", "\n", "\n", 
       RowBox[{"nBlock", "+=", "j"}]}]}], "\n", "]"}]}], ";"}], "\n"}], "\n", 

 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getTotalBlocksInRow", "[", "nRow_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "nRow", "]"}], ",", "\n", 
        RowBox[{"nelx", "-", "1"}], ",", "\n", "nelx"}], "\n", "]"}]}], "\n", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"isBlockOnRightEdge", "[", 
     RowBox[{"{", 
      RowBox[{"nRow_", ",", "j_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "nRow", "]"}], ",", "\n", 
        RowBox[{"j", "==", 
         RowBox[{"nelx", "-", "1"}]}], ",", "\n", 
        RowBox[{"j", "==", "nelx"}]}], "]"}]}], "\n", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"isBlockOnLeftEdge", "[", 
     RowBox[{"{", 
      RowBox[{"nRow_", ",", "j_"}], "}"}], "]"}], ":=", 
    RowBox[{"j", "==", "1"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"isBlockHalved", "[", 
    RowBox[{"{", 
     RowBox[{"nRow_", ",", "j_"}], "}"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"OddQ", "[", "nRow", "]"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"isBlockOnLeftEdge", "[", 
       RowBox[{"{", 
        RowBox[{"nRow", ",", "j"}], "}"}], "]"}], "||", 
      RowBox[{"isBlockOnRightEdge", "[", 
       RowBox[{"{", 
        RowBox[{"nRow", ",", "j"}], "}"}], "]"}]}], ")"}]}]}], 
  ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getBlockLoads", "[", 
    RowBox[{"{", 
     RowBox[{"nRow_", ",", "j_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "pvnew", ",", "Ns", ",", "Ts", ",", "Ncs", ",", "Tcs", ",", "Ncd", ",", 
       "Tcd", ",", "Nd", ",", "Td", ",", "nBlock", ",", "blockULPos", ",", 
       "blockURPos", ",", "nBlockUL", ",", "nBlockUR"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"nBlock", "=", 
       RowBox[{"getBlockNum", "[", 
        RowBox[{"{", 
         RowBox[{"nRow", ",", "j"}], "}"}], "]"}]}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"nRow", "==", "1"}], ",", "\n", "\n", 
        RowBox[{"(*", 
         RowBox[{"first", " ", "row"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"pvnew", "=", 
          RowBox[{"\[Sigma]v", "[", 
           RowBox[{"[", "nBlock", "]"}], "]"}]}], ";"}], ",", "\n", "\n", 
        RowBox[{"(*", 
         RowBox[{"other", " ", "rows"}], "*)"}], "\n", 
        RowBox[{"(*", 
         RowBox[{"get", " ", "upper", " ", 
          RowBox[{"blocks", "'"}], " ", "positions"}], "*)"}], "\n", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"EvenQ", "[", "nRow", "]"}], ",", "\n", 
           RowBox[{
            RowBox[{"blockULPos", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nRow", "-", "1"}], ",", "j"}], "}"}]}], ";", 
            RowBox[{"blockURPos", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nRow", "-", "1"}], ",", 
               RowBox[{"j", "+", "1"}]}], "}"}]}], ";"}], ",", "\n", 
           RowBox[{
            RowBox[{"blockULPos", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nRow", "-", "1"}], ",", 
               RowBox[{"j", "-", "1"}]}], "}"}]}], ";", 
            RowBox[{"blockURPos", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"nRow", "-", "1"}], ",", "j"}], "}"}]}], ";"}]}], "\n",
           "]"}], ";", "\n", 
         RowBox[{"nBlockUL", "=", 
          RowBox[{"getBlockNum", "[", "blockULPos", "]"}]}], ";", "\n", 
         RowBox[{"nBlockUR", "=", 
          RowBox[{"getBlockNum", "[", "blockURPos", "]"}]}], ";", "\n", "\n", 
         
         RowBox[{"(*", 
          RowBox[{
          "get", " ", "loads", " ", "acting", " ", "on", " ", "top", " ", 
           "from", " ", "the", " ", "reactions", " ", "of", " ", "the", " ", 
           "upper", " ", "blocks"}], "*)"}], "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"isBlockOnLeftEdge", "[", 
               RowBox[{"{", 
                RowBox[{"nRow", ",", "j"}], "}"}], "]"}], "||", 
              RowBox[{"isBlockOnRightEdge", "[", 
               RowBox[{"{", 
                RowBox[{"nRow", ",", "j"}], "}"}], "]"}]}], ")"}]}], ",", 
           "\n", 
           RowBox[{"(*", 
            RowBox[{"block", " ", "is", " ", "internal"}], "*)"}], "\n", 
           RowBox[{
            RowBox[{"Ncs", "=", 
             RowBox[{"\[Sigma]v", "[", 
              RowBox[{"[", 
               RowBox[{"nBlockUL", ",", "11"}], "]"}], "]"}]}], ";", 
            RowBox[{"Tcs", "=", 
             RowBox[{"\[Sigma]v", "[", 
              RowBox[{"[", 
               RowBox[{"nBlockUL", ",", "12"}], "]"}], "]"}]}], ";", "\n", 
            RowBox[{"Ncd", "=", 
             RowBox[{"\[Sigma]v", "[", 
              RowBox[{"[", 
               RowBox[{"nBlockUR", ",", "7"}], "]"}], "]"}]}], ";", 
            RowBox[{"Tcd", "=", 
             RowBox[{"\[Sigma]v", "[", 
              RowBox[{"[", 
               RowBox[{"nBlockUR", ",", "8"}], "]"}], "]"}]}], ";", "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"contacts", "[", 
                RowBox[{"[", "nBlockUL", "]"}], "]"}], "==", "3"}], ",", "\n", 
              RowBox[{
               RowBox[{"Ns", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUL", ",", "9"}], "]"}], "]"}]}], ";", 
               RowBox[{"Ts", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUL", ",", "10"}], "]"}], "]"}]}], ";"}], ",",
               "\n", 
              RowBox[{
               RowBox[{"Ns", "=", "0"}], ";", 
               RowBox[{"Ts", "=", "0"}], ";"}]}], "\n", "]"}], ";", "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"contacts", "[", 
                RowBox[{"[", "nBlockUR", "]"}], "]"}], "==", "2"}], ",", "\n", 
              RowBox[{
               RowBox[{"Nd", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUR", ",", "9"}], "]"}], "]"}]}], ";", 
               RowBox[{"Td", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUR", ",", "10"}], "]"}], "]"}]}], ";"}], ",",
               "\n", 
              RowBox[{
               RowBox[{"Nd", "=", "0"}], ";", 
               RowBox[{"Td", "=", "0"}], ";"}]}], "\n", "]"}], ";"}], ",", 
           "\n", "\n", 
           RowBox[{"(*", 
            RowBox[{"block", " ", "in", " ", "not", " ", "internal"}], "*)"}],
            "\n", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"isBlockOnLeftEdge", "[", 
               RowBox[{"{", 
                RowBox[{"nRow", ",", "j"}], "}"}], "]"}], ",", 
              RowBox[{"(*", 
               RowBox[{"TODO", ":", " ", 
                RowBox[{"modify", " ", "to", " ", "support", " ", "edge", " ", 
                 RowBox[{"blocks", "!"}]}]}], "*)"}], "\n", 
              RowBox[{"(*", 
               RowBox[{
               "block", " ", "on", " ", "the", " ", "left", " ", "edge"}], 
               "*)"}], "\n", 
              RowBox[{
               RowBox[{"Ncd", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUR", ",", "7"}], "]"}], "]"}]}], ";", 
               RowBox[{"Tcd", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUR", ",", "8"}], "]"}], "]"}]}], ";", "\n", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"contacts", "[", 
                   RowBox[{"[", "nBlockUR", "]"}], "]"}], "==", "2"}], ",", 
                 "\n", 
                 RowBox[{
                  RowBox[{"Nd", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUR", ",", "9"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Td", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUR", ",", "10"}], "]"}], "]"}]}], ";"}], 
                 ",", "\n", 
                 RowBox[{
                  RowBox[{"Nd", "=", "0"}], ";", 
                  RowBox[{"Td", "=", "0"}], ";"}]}], "\n", "]"}], ";", "\n", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"EvenQ", "[", "nRow", "]"}], ",", "\n", 
                 RowBox[{
                  RowBox[{"Ns", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUL", ",", "9"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Ts", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUL", ",", "10"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Ncs", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUL", ",", "11"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Tcs", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUL", ",", "12"}], "]"}], "]"}]}], ";"}], 
                 ",", "\n", 
                 RowBox[{
                  RowBox[{"Ns", "=", "0"}], ";", 
                  RowBox[{"Ts", "=", "0"}], ";", 
                  RowBox[{"Ncs", "=", "0"}], ";", 
                  RowBox[{"Tcs", "=", "0"}], ";"}]}], "\n", "]"}], ";"}], ",",
               "\n", 
              RowBox[{"(*", 
               RowBox[{
               "block", " ", "on", " ", "the", " ", "right", " ", "edge"}], 
               "*)"}], "\n", 
              RowBox[{
               RowBox[{"Ncs", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUL", ",", "11"}], "]"}], "]"}]}], ";", 
               RowBox[{"Tcs", "=", 
                RowBox[{"\[Sigma]v", "[", 
                 RowBox[{"[", 
                  RowBox[{"nBlockUL", ",", "12"}], "]"}], "]"}]}], ";", "\n", 
               
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"contacts", "[", 
                   RowBox[{"[", "nBlockUL", "]"}], "]"}], "==", "3"}], ",", 
                 "\n", 
                 RowBox[{
                  RowBox[{"Ns", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUL", ",", "9"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Ts", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUL", ",", "10"}], "]"}], "]"}]}], ";"}], 
                 ",", "\n", 
                 RowBox[{
                  RowBox[{"Ns", "=", "0"}], ";", 
                  RowBox[{"Ts", "=", "0"}], ";"}]}], "\n", "]"}], ";", "\n", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"EvenQ", "[", "nRow", "]"}], ",", "\n", 
                 RowBox[{
                  RowBox[{"Nd", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUR", ",", "9"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Td", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUR", ",", "10"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Ncd", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUR", ",", "7"}], "]"}], "]"}]}], ";", 
                  RowBox[{"Tcd", "=", 
                   RowBox[{"\[Sigma]v", "[", 
                    RowBox[{"[", 
                    RowBox[{"nBlockUR", ",", "8"}], "]"}], "]"}]}], ";"}], 
                 ",", "\n", 
                 RowBox[{
                  RowBox[{"Nd", "=", "0"}], ";", 
                  RowBox[{"Td", "=", "0"}], ";", 
                  RowBox[{"Ncd", "=", "0"}], ";", 
                  RowBox[{"Tcd", "=", "0"}], ";"}]}], "\n", "]"}], ";"}]}], 
             "\n", "]"}], ";"}]}], "\n", "]"}], ";", "\n", 
         RowBox[{"pvnew", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Ns", ",", "Ts", ",", 
              RowBox[{"Ncs", "+", "Ncd"}], ",", 
              RowBox[{"Tcs", "+", "Tcd"}], ",", "Nd", ",", "Td"}], "}"}], ",", 
            RowBox[{"\[Sigma]v", "[", 
             RowBox[{"[", 
              RowBox[{"nBlock", ",", 
               RowBox[{"7", ";;", "12"}]}], "]"}], "]"}]}], "]"}]}], ";"}]}], 
       "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"\[Sigma]h", "[", 
         RowBox[{"[", 
          RowBox[{"nBlock", "+", "nRow", "-", "1"}], "]"}], "]"}], ",", 
        "pvnew", ",", 
        RowBox[{"\[Sigma]h", "[", 
         RowBox[{"[", 
          RowBox[{"nBlock", "+", "nRow"}], "]"}], "]"}]}], "]"}]}]}], "\n", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682579890872397*^9, 3.6825799003430223`*^9}, {
  3.682590199628479*^9, 3.682590262460189*^9}, {3.682590293455785*^9, 
  3.682590295903391*^9}, {3.682590332078925*^9, 3.682590334373008*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"findSolvableBlockSequence", "[", "nRow_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "j", ",", "shear", ",", "rowShears", ",", "blockSequence", ",", "len", 
       ",", "direction", ",", "criticalBlocks", ",", "result"}], "}"}], ",", 
     "\n", 
     RowBox[{
      RowBox[{"rowShears", "=", 
       RowBox[{"Total", "[", 
        RowBox[{
         RowBox[{"\[Sigma]v", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{
             RowBox[{"getBlockNum", "[", 
              RowBox[{"{", 
               RowBox[{"nRow", ",", "1"}], "}"}], "]"}], ";;", 
             RowBox[{"getBlockNum", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"nRow", "+", "1"}], ",", "0"}], "}"}], "]"}]}], ",", 
            RowBox[{"2", ";;", "6", ";;", "2"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"rowShears", "=", 
       RowBox[{"SplitBy", "[", 
        RowBox[{"rowShears", ",", 
         RowBox[{
          RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "build", " ", "block", " ", "sequence", " ", "and", " ", "direction", 
        " ", "lists"}], "*)"}], "\n", 
      RowBox[{"blockSequence", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"len", "=", "0"}], ";", 
      RowBox[{"direction", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "rowShears", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"shear", "=", 
          RowBox[{"Total", "[", 
           RowBox[{"rowShears", "[", 
            RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"blockSequence", ",", 
           RowBox[{"Range", "[", 
            RowBox[{
             RowBox[{"len", "+", "1"}], ",", 
             RowBox[{"len", "+", 
              RowBox[{"Length", "[", 
               RowBox[{"rowShears", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], "]"}]}], "]"}], 
         ";", "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"shear", "<", "0"}], ",", "\n", 
           RowBox[{
            RowBox[{
             RowBox[{"blockSequence", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", 
             RowBox[{"Reverse", "[", 
              RowBox[{"blockSequence", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", "\n", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"direction", ",", 
              RowBox[{"-", "1"}]}], "]"}], ";"}], ",", "\n", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"direction", ",", "1"}], "]"}], ";"}]}], "\n", "]"}], 
         ";", "\n", 
         RowBox[{"len", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"Flatten", "[", "blockSequence", "]"}], "]"}]}], ";"}]}], 
       "\n", "]"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "find", " ", "potentially", " ", "critical", " ", "blocks", " ", "in", 
        " ", "the", " ", "sequence"}], "*)"}], "\n", 
      RowBox[{"criticalBlocks", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "2"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", "direction", "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"direction", "[", 
              RowBox[{"[", 
               RowBox[{"j", "-", "1"}], "]"}], "]"}], ">", "0"}], "&&", 
            RowBox[{
             RowBox[{"direction", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "<", "0"}]}], ",", "\n", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"criticalBlocks", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Last", "[", 
                 RowBox[{"blockSequence", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", "-", "1"}], "]"}], "]"}], "]"}], ",", 
                RowBox[{"Last", "[", 
                 RowBox[{"blockSequence", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
            ";"}]}], "\n", "]"}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{
       RowBox[{"result", "[", "\"\<seq\>\"", "]"}], "=", "blockSequence"}], 
      ";", "\n", 
      RowBox[{
       RowBox[{"result", "[", "\"\<dir\>\"", "]"}], "=", "direction"}], ";", 
      "\n", 
      RowBox[{
       RowBox[{"result", "[", "\"\<cri\>\"", "]"}], "=", "criticalBlocks"}], 
      ";", "\n", "result"}]}], "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"updateStress", "[", 
    RowBox[{"pBlock_", ",", 
     RowBox[{"{", 
      RowBox[{"nRow_", ",", "j_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "blockNum", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"blockNum", "=", 
       RowBox[{"getBlockNum", "[", 
        RowBox[{"{", 
         RowBox[{"nRow", ",", "j"}], "}"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"\[Sigma]v", "[", 
        RowBox[{"[", "blockNum", "]"}], "]"}], "=", 
       RowBox[{"pBlock", "[", 
        RowBox[{"[", 
         RowBox[{"5", ";;", "16"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{
       RowBox[{"\[Sigma]h", "[", 
        RowBox[{"[", 
         RowBox[{"blockNum", "+", "nRow", "-", "1"}], "]"}], "]"}], "=", 
       RowBox[{"pBlock", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "interface", " ", "on", " ", "the", " ", "left", " ", "side", " ", 
        "of", " ", "the", " ", "current", " ", "block"}], "*)"}], "\n", 
      RowBox[{
       RowBox[{"\[Sigma]h", "[", 
        RowBox[{"[", 
         RowBox[{"blockNum", "+", "nRow"}], "]"}], "]"}], "=", 
       RowBox[{"pBlock", "[", 
        RowBox[{"[", 
         RowBox[{"17", ";;", "20"}], "]"}], "]"}]}], ";"}]}], 
    RowBox[{"(*", 
     RowBox[{
     "interface", " ", "on", " ", "the", " ", "right", " ", "side", " ", "of",
       " ", "the", " ", "current", " ", "block"}], "*)"}], "\n", "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkRowEquilibrium", "[", 
    RowBox[{"nRow_", ",", "criticalBlocksInRow_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "unbalancedBlocksData", ",", "edgeBlocksEqCheck", ",", 
       "unbalancedBlocks", ",", "unbalancedBlockLoads", ",", "j", ",", 
       "firstBlockLoads", ",", "lastBlockLoads", ",", "leftBlockLoads", ",", 
       "rightBlockLoads", ",", "contact"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"unbalancedBlocks", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"unbalancedBlockLoads", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "check", " ", "first", " ", "and", " ", "last", " ", "block", " ", 
        "in", " ", "the", " ", "row"}], "*)"}], "\n", 
      RowBox[{"firstBlockLoads", "=", 
       RowBox[{"getBlockLoads", "[", 
        RowBox[{"{", 
         RowBox[{"nRow", ",", "1"}], "}"}], "]"}]}], ";", "\n", 
      RowBox[{"lastBlockLoads", "=", 
       RowBox[{"getBlockLoads", "[", 
        RowBox[{"{", 
         RowBox[{"nRow", ",", 
          RowBox[{"getTotalBlocksInRow", "[", "nRow", "]"}]}], "}"}], "]"}]}],
       ";", "\n", 
      RowBox[{"edgeBlocksEqCheck", "=", 
       RowBox[{
        RowBox[{"firstBlockLoads", "[", 
         RowBox[{"[", 
          RowBox[{"1", ";;", "4"}], "]"}], "]"}], "==", 
        RowBox[{"lastBlockLoads", "[", 
         RowBox[{"[", 
          RowBox[{"17", ";;", "20"}], "]"}], "]"}], "==", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
       "check", " ", "the", " ", "interface", " ", "of", " ", "each", " ", 
        "pair", " ", "of", " ", "critical", " ", "blocks"}], "*)"}], "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{
         RowBox[{"j", "<=", 
          RowBox[{"Length", "[", "criticalBlocksInRow", "]"}]}], "&&", 
         "edgeBlocksEqCheck"}], ",", 
        RowBox[{"j", "++"}], ",", "\n", 
        RowBox[{"(*", 
         RowBox[{"solve", " ", "the", " ", "left", " ", "block"}], "*)"}], 
        "\n", 
        RowBox[{
         RowBox[{"leftBlockLoads", "=", 
          RowBox[{"getBlockLoads", "[", 
           RowBox[{"{", 
            RowBox[{"nRow", ",", 
             RowBox[{"criticalBlocksInRow", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\n", 
         RowBox[{"contact", "=", 
          RowBox[{"contacts", "[", 
           RowBox[{"[", 
            RowBox[{"getBlockNum", "[", 
             RowBox[{"{", 
              RowBox[{"nRow", ",", 
               RowBox[{"criticalBlocksInRow", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "}"}], "]"}], "]"}],
            "]"}]}], ";", "\n", 
         RowBox[{"leftBlockLoads", "=", 
          RowBox[{"solveBlock", "[", 
           RowBox[{"leftBlockLoads", ",", "contact", ",", 
            RowBox[{"{", 
             RowBox[{"nRow", ",", 
              RowBox[{"criticalBlocksInRow", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "}"}], ",", "1"}], 
           "]"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{"solve", " ", "the", " ", "right", " ", "block"}], "*)"}], 
         "\n", 
         RowBox[{"rightBlockLoads", "=", 
          RowBox[{"getBlockLoads", "[", 
           RowBox[{"{", 
            RowBox[{"nRow", ",", 
             RowBox[{"criticalBlocksInRow", "[", 
              RowBox[{"[", 
               RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}]}], ";", 
         "\n", 
         RowBox[{"contact", "=", 
          RowBox[{"contacts", "[", 
           RowBox[{"[", 
            RowBox[{"getBlockNum", "[", 
             RowBox[{"{", 
              RowBox[{"nRow", ",", 
               RowBox[{"criticalBlocksInRow", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}], "]"}],
            "]"}]}], ";", "\n", 
         RowBox[{"rightBlockLoads", "=", 
          RowBox[{"solveBlock", "[", 
           RowBox[{"rightBlockLoads", ",", "contact", ",", 
            RowBox[{"{", 
             RowBox[{"nRow", ",", 
              RowBox[{"criticalBlocksInRow", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "2"}], "]"}], "]"}]}], "}"}], ",", 
            RowBox[{"-", "1"}]}], "]"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"check", " ", "the", " ", "interface"}], ",", " ", 
           RowBox[{
           "if", " ", "the", " ", "current", " ", "pair", " ", "is", " ", 
            "unbalanced", " ", "save", " ", "the", " ", "block", " ", 
            "numbers", " ", "and", " ", "solutions"}]}], "*)"}], "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"leftBlockLoads", "[", 
               RowBox[{"[", 
                RowBox[{"17", ";;", "20"}], "]"}], "]"}], "==", 
              RowBox[{"rightBlockLoads", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ")"}]}], ",", "\n", 
           
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"unbalancedBlocks", ",", 
              RowBox[{"criticalBlocksInRow", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ";", "\n", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"unbalancedBlockLoads", ",", 
              RowBox[{"{", 
               RowBox[{"leftBlockLoads", ",", "rightBlockLoads"}], "}"}]}], 
             "]"}], ";"}]}], "\n", "]"}], ";"}]}], "\n", "]"}], ";", "\n", 
      "\n", 
      RowBox[{
       RowBox[{"unbalancedBlocksData", "[", "\"\<eq_check\>\"", "]"}], "=", 
       "edgeBlocksEqCheck"}], ";", "\n", 
      RowBox[{
       RowBox[{"unbalancedBlocksData", "[", "\"\<blocks\>\"", "]"}], "=", 
       "unbalancedBlocks"}], ";", "\n", 
      RowBox[{
       RowBox[{"unbalancedBlocksData", "[", "\"\<loads\>\"", "]"}], "=", 
       "unbalancedBlockLoads"}], ";", "\n", "unbalancedBlocksData"}]}], "\n", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6825715686348467`*^9, 3.68257163523773*^9}, {
   3.682571750001381*^9, 3.682571756920067*^9}, {3.682571793873863*^9, 
   3.682571807300351*^9}, {3.682571945893544*^9, 3.682572035397717*^9}, 
   3.6825756308381453`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"computeGlobalRot", "[", 
    RowBox[{"leftBlockLoads_", ",", "rightBlockLoads_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
       "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", "Rc",
        ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", "Ldb", 
       ",", "Vdb", ",", "M1", ",", "M2"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
         "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", 
         "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", 
         "Ldb", ",", "Vdb"}], "}"}], "=", "leftBlockLoads"}], ";", "\n", 
      RowBox[{"M1", "=", 
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Ns", "+", "Vsu", "+", "Vsb", "+", 
             RowBox[{"Nc", "/", "2"}], "+", 
             RowBox[{"P", "/", "2"}]}], ")"}], "b"}], "-", 
          RowBox[{"h", 
           RowBox[{"(", 
            RowBox[{"Lsu", "+", "Ts", "+", "Tc", "+", "Td"}], ")"}]}]}], 
         ")"}]}]}], ";", "\n", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
         "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", 
         "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", 
         "Ldb", ",", "Vdb"}], "}"}], "=", "rightBlockLoads"}], ";", "\n", 
      RowBox[{"M2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Nc", "/", "2"}], "+", 
           RowBox[{"P", "/", "2"}], "+", "Nd", "-", "Vdu", "-", "Vdb"}], 
          ")"}], "b"}], "+", 
        RowBox[{"h", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Ldu"}], "+", "Ts", "+", "Tc", "+", "Td"}], 
          ")"}]}]}]}], ";", "\n", "\n", 
      RowBox[{"M1", "+", "M2"}]}]}], "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"correctAndBuildNextBlocksData", "[", 
    RowBox[{"blockToCorrect_", ",", "nRow_", ",", 
     RowBox[{"{", 
      RowBox[{"leftBlock_", ",", "rightBlock_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"$leftBlockLoads_", ",", "$rightBlockLoads_"}], "}"}]}], "]"}], 
   ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "leftBlockLoads", ",", "rightBlockLoads", ",", "nextBlocksData", ",", 
       "rowEqCheck", ",", "nextBlocks", ",", "nextBlockLoads", ",", "nextDir",
        ",", "nextLeftLoads", ",", "nextRightLoads"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"leftBlockLoads", "=", "$leftBlockLoads"}], ";", 
      RowBox[{"rightBlockLoads", "=", "$rightBlockLoads"}], ";", "\n", 
      RowBox[{"rowEqCheck", "=", "True"}], ";", 
      RowBox[{"nextBlocks", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"nextBlockLoads", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"nextDir", "=", "0"}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"blockToCorrect", "==", "rightBlock"}], ",", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"rightBlockLoads", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "4"}], "]"}], "]"}], "=", 
          RowBox[{"leftBlockLoads", "[", 
           RowBox[{"[", 
            RowBox[{"17", ";;", "20"}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "solve", " ", "right", " ", "block", " ", "with", " ", "corrected", 
           " ", "loads"}], "*)"}], "\n", 
         RowBox[{"nextLeftLoads", "=", 
          RowBox[{"correctBlock", "[", 
           RowBox[{"rightBlockLoads", ",", 
            RowBox[{"contacts", "[", 
             RowBox[{"[", 
              RowBox[{"getBlockNum", "[", 
               RowBox[{"{", 
                RowBox[{"nRow", ",", "rightBlock"}], "}"}], "]"}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"nRow", ",", "rightBlock"}], "}"}]}], "]"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{"update", " ", "stress"}], "*)"}], "\n", 
         RowBox[{"updateStress", "[", 
          RowBox[{"nextLeftLoads", ",", 
           RowBox[{"{", 
            RowBox[{"nRow", ",", "rightBlock"}], "}"}]}], "]"}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "check", " ", "if", " ", "the", " ", "wave", " ", "needs", " ", 
           "to", " ", "continue"}], "*)"}], "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"isBlockOnRightEdge", "[", 
            RowBox[{"{", 
             RowBox[{"nRow", ",", "rightBlock"}], "}"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "check", " ", "equilibrium", " ", "of", " ", "the", " ", "last", 
             " ", "block", " ", "in", " ", "the", " ", "row"}], "*)"}], "\n", 
           
           RowBox[{
            RowBox[{"rowEqCheck", "=", 
             RowBox[{
              RowBox[{"nextLeftLoads", "[", 
               RowBox[{"[", 
                RowBox[{"17", ";;", "20"}], "]"}], "]"}], "==", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], ";"}], 
           ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "check", " ", "if", " ", "adiacent", " ", "blocks", " ", "will", 
             " ", "need", " ", "to", " ", "be", " ", "corrected"}], "*)"}], 
           "\n", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nextLeftLoads", "[", 
                RowBox[{"[", 
                 RowBox[{"17", ";;", "20"}], "]"}], "]"}], "!=", 
               RowBox[{"rightBlockLoads", "[", 
                RowBox[{"[", 
                 RowBox[{"17", ";;", "20"}], "]"}], "]"}]}], ",", "\n", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "right", " ", "interface", " ", "has", " ", "changed"}], ",", 
                " ", 
                RowBox[{
                "wave", " ", "continues", " ", "towards", " ", "the", " ", 
                 "right"}]}], "*)"}], "\n", 
              RowBox[{
               RowBox[{"nextBlocks", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"leftBlock", "+", "1"}], ",", 
                  RowBox[{"rightBlock", "+", "1"}]}], "}"}]}], ";", "\n", 
               RowBox[{"nextRightLoads", "=", 
                RowBox[{"getBlockLoads", "[", 
                 RowBox[{"{", 
                  RowBox[{"nRow", ",", 
                   RowBox[{"rightBlock", "+", "1"}]}], "}"}], "]"}]}], ";", 
               "\n", 
               RowBox[{"nextBlockLoads", "=", 
                RowBox[{"{", 
                 RowBox[{"nextLeftLoads", ",", "nextRightLoads"}], "}"}]}], 
               ";", "\n", 
               RowBox[{"nextDir", "=", "1"}], ";"}]}], "\n", "]"}], ";", "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nextLeftLoads", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "4"}], "]"}], "]"}], "!=", 
               RowBox[{"rightBlockLoads", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "left", " ", "interface", " ", "has", " ", "changed"}], ",", 
                " ", 
                RowBox[{
                "wave", " ", "continues", " ", "towards", " ", "the", " ", 
                 "left"}]}], "*)"}], "\n", 
              RowBox[{
               RowBox[{"nextBlocks", "=", 
                RowBox[{"{", 
                 RowBox[{"leftBlock", ",", "rightBlock"}], "}"}]}], ";", "\n", 
               RowBox[{"nextRightLoads", "=", "nextLeftLoads"}], ";", "\n", 
               RowBox[{"nextLeftLoads", "=", 
                RowBox[{"getBlockLoads", "[", 
                 RowBox[{"{", 
                  RowBox[{"nRow", ",", "leftBlock"}], "}"}], "]"}]}], ";", 
               "\n", 
               RowBox[{"nextBlockLoads", "=", 
                RowBox[{"{", 
                 RowBox[{"nextLeftLoads", ",", "nextRightLoads"}], "}"}]}], 
               ";", "\n", 
               RowBox[{"nextDir", "=", 
                RowBox[{"-", "1"}]}], ";"}]}], "\n", "]"}], ";"}]}], "\n", 
          "]"}], ";"}], "\n", ",", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"leftBlockLoads", "[", 
           RowBox[{"[", 
            RowBox[{"17", ";;", "20"}], "]"}], "]"}], "=", 
          RowBox[{"rightBlockLoads", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "solve", " ", "left", " ", "block", " ", "with", " ", "corrected", 
           " ", "loads"}], "*)"}], "\n", 
         RowBox[{"nextRightLoads", "=", 
          RowBox[{"correctBlock", "[", 
           RowBox[{"leftBlockLoads", ",", 
            RowBox[{"contacts", "[", 
             RowBox[{"[", 
              RowBox[{"getBlockNum", "[", 
               RowBox[{"{", 
                RowBox[{"nRow", ",", "leftBlock"}], "}"}], "]"}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"nRow", ",", "leftBlock"}], "}"}]}], "]"}]}], ";", "\n", 
         
         RowBox[{"(*", 
          RowBox[{"update", " ", "stress"}], "*)"}], "\n", 
         RowBox[{"updateStress", "[", 
          RowBox[{"nextRightLoads", ",", 
           RowBox[{"{", 
            RowBox[{"nRow", ",", "leftBlock"}], "}"}]}], "]"}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{
          "check", " ", "if", " ", "the", " ", "wave", " ", "needs", " ", 
           "to", " ", "continue"}], "*)"}], "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"isBlockOnLeftEdge", "[", 
            RowBox[{"{", 
             RowBox[{"nRow", ",", "leftBlock"}], "}"}], "]"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "check", " ", "equilibrium", " ", "of", " ", "the", " ", "first", 
             " ", "block", " ", "in", " ", "the", " ", "row"}], "*)"}], "\n", 
           
           RowBox[{
            RowBox[{"rowEqCheck", "=", 
             RowBox[{
              RowBox[{"nextRightLoads", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "4"}], "]"}], "]"}], "==", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], ";"}], 
           ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "check", " ", "if", " ", "adiacent", " ", "blocks", " ", "will", 
             " ", "need", " ", "to", " ", "be", " ", "corrected"}], "*)"}], 
           "\n", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nextRightLoads", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "4"}], "]"}], "]"}], "!=", 
               RowBox[{"leftBlockLoads", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ",", "\n", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "left", " ", "interface", " ", "has", " ", "changed"}], ",", 
                " ", 
                RowBox[{
                "wave", " ", "continues", " ", "towards", " ", "the", " ", 
                 "left"}]}], "*)"}], "\n", 
              RowBox[{
               RowBox[{"nextBlocks", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"leftBlock", "-", "1"}], ",", 
                  RowBox[{"rightBlock", "-", "1"}]}], "}"}]}], ";", "\n", 
               RowBox[{"nextLeftLoads", "=", 
                RowBox[{"getBlockLoads", "[", 
                 RowBox[{"{", 
                  RowBox[{"nRow", ",", 
                   RowBox[{"leftBlock", "-", "1"}]}], "}"}], "]"}]}], ";", 
               "\n", 
               RowBox[{"nextBlockLoads", "=", 
                RowBox[{"{", 
                 RowBox[{"nextLeftLoads", ",", "nextRightLoads"}], "}"}]}], 
               ";", "\n", 
               RowBox[{"nextDir", "=", 
                RowBox[{"-", "1"}]}], ";"}]}], "\n", "]"}], ";", "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"nextRightLoads", "[", 
                RowBox[{"[", 
                 RowBox[{"17", ";;", "20"}], "]"}], "]"}], "!=", 
               RowBox[{"leftBlockLoads", "[", 
                RowBox[{"[", 
                 RowBox[{"17", ";;", "20"}], "]"}], "]"}]}], ",", "\n", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                "right", " ", "interface", " ", "has", " ", "changed"}], ",", 
                " ", 
                RowBox[{
                "wave", " ", "continues", " ", "towards", " ", "the", " ", 
                 "right"}]}], "*)"}], "\n", 
              RowBox[{
               RowBox[{"nextBlocks", "=", 
                RowBox[{"{", 
                 RowBox[{"leftBlock", ",", "rightBlock"}], "}"}]}], ";", "\n", 
               RowBox[{"nextLeftLoads", "=", "nextRightLoads"}], ";", "\n", 
               RowBox[{"nextRightLoads", "=", 
                RowBox[{"getBlockLoads", "[", 
                 RowBox[{"{", 
                  RowBox[{"nRow", ",", "rightBlock"}], "}"}], "]"}]}], ";", 
               "\n", 
               RowBox[{"nextBlockLoads", "=", 
                RowBox[{"{", 
                 RowBox[{"nextLeftLoads", ",", "nextRightLoads"}], "}"}]}], 
               ";", "\n", 
               RowBox[{"nextDir", "=", "1"}], ";"}]}], "\n", "]"}], ";"}]}], 
          "\n", "]"}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{
       RowBox[{"nextBlocksData", "[", "\"\<eq_check\>\"", "]"}], "=", 
       "rowEqCheck"}], ";", "\n", 
      RowBox[{
       RowBox[{"nextBlocksData", "[", "\"\<blocks\>\"", "]"}], "=", 
       "nextBlocks"}], ";", "\n", 
      RowBox[{
       RowBox[{"nextBlocksData", "[", "\"\<loads\>\"", "]"}], "=", 
       "nextBlockLoads"}], ";", "\n", 
      RowBox[{
       RowBox[{"nextBlocksData", "[", "\"\<dir\>\"", "]"}], "=", "nextDir"}], 
      ";", "\n", "nextBlocksData"}]}], "\n", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682570884948374*^9, 3.6825708995400343`*^9}, {
  3.682570950578252*^9, 3.6825710169652977`*^9}, {3.682571054458555*^9, 
  3.682571136818894*^9}, {3.6825711962547197`*^9, 3.682571230528304*^9}, {
  3.682571265320354*^9, 3.6825713255415707`*^9}, {3.682571365618573*^9, 
  3.682571386727021*^9}, {3.682577523763052*^9, 3.6825775299502897`*^9}, {
  3.682606119401218*^9, 3.682606136029325*^9}, {3.682606166079567*^9, 
  3.682606220163816*^9}, {3.682606393468143*^9, 3.682606395271212*^9}, {
  3.682606457422578*^9, 3.6826064643463287`*^9}, {3.6826068729067717`*^9, 
  3.682606873875682*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"correctUnbalancedBlocks", "[", 
    RowBox[{"nRow_", ",", 
     RowBox[{"{", 
      RowBox[{"leftBlock_", ",", "rightBlock_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"leftBlockLoads_", ",", "rightBlockLoads_"}], "}"}], ",", 
     "dir_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "nextBlocksData", ",", "leftHasBaseContact", ",", 
       "rightHasBaseContact"}], "}"}], ",", "\n", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"leftBlockLoads", "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"11", ",", "13"}], "}"}], "]"}], "]"}], "!=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ",", "\n", 
        RowBox[{
         RowBox[{"leftHasBaseContact", "=", "True"}], ";"}], ",", "\n", 
        RowBox[{
         RowBox[{"leftHasBaseContact", "=", "False"}], ";"}]}], "\n", "]"}], 
      ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"rightBlockLoads", "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"13", ",", "15"}], "}"}], "]"}], "]"}], "!=", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ",", "\n", 
        RowBox[{
         RowBox[{"rightHasBaseContact", "=", "True"}], ";"}], ",", "\n", 
        RowBox[{
         RowBox[{"rightHasBaseContact", "=", "False"}], ";"}]}], "\n", "]"}], 
      ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"first", " ", "correction"}], "*)"}], "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dir", "==", "0"}], ",", "\n", "\n", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"leftHasBaseContact", "&&", "rightHasBaseContact"}], ",", 
           "\n", 
           RowBox[{"(*", 
            RowBox[{
            "both", " ", "blocks", " ", "have", " ", "base", " ", 
             "contacts"}], "*)"}], "\n", 
           RowBox[{"(*", 
            RowBox[{
            "check", " ", "which", " ", "block", " ", "has", " ", "the", " ", 
             "bigger", " ", "Lb"}], "*)"}], "\n", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"leftBlockLoads", "[", 
                RowBox[{"[", "19", "]"}], "]"}], ">", 
               RowBox[{"rightBlockLoads", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", 
              RowBox[{"(*", 
               RowBox[{"Ldb", ">", "Lsb"}], "*)"}], "\n", 
              RowBox[{
               RowBox[{"nextBlocksData", "=", 
                RowBox[{"correctAndBuildNextBlocksData", "[", 
                 RowBox[{"rightBlock", ",", "nRow", ",", 
                  RowBox[{"{", 
                   RowBox[{"leftBlock", ",", "rightBlock"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"leftBlockLoads", ",", "rightBlockLoads"}], 
                   "}"}]}], "]"}]}], ";"}], ",", "\n", 
              RowBox[{"(*", 
               RowBox[{"Ldb", "<", "Lsb"}], "*)"}], "\n", 
              RowBox[{
               RowBox[{"nextBlocksData", "=", 
                RowBox[{"correctAndBuildNextBlocksData", "[", 
                 RowBox[{"leftBlock", ",", "nRow", ",", 
                  RowBox[{"{", 
                   RowBox[{"leftBlock", ",", "rightBlock"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"leftBlockLoads", ",", "rightBlockLoads"}], 
                   "}"}]}], "]"}]}], ";"}]}], "\n", "]"}], ";"}]}], "\n", 
          "]"}], ";", "\n", "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"leftHasBaseContact", "&&", 
            RowBox[{"!", "rightHasBaseContact"}]}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "only", " ", "left", " ", "block", " ", "has", " ", "base", " ", 
             "contacts"}], "*)"}], "\n", 
           RowBox[{
            RowBox[{"nextBlocksData", "=", 
             RowBox[{"correctAndBuildNextBlocksData", "[", 
              RowBox[{"leftBlock", ",", "nRow", ",", 
               RowBox[{"{", 
                RowBox[{"leftBlock", ",", "rightBlock"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"leftBlockLoads", ",", "rightBlockLoads"}], "}"}]}], 
              "]"}]}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", "leftHasBaseContact"}], "&&", 
            "rightHasBaseContact"}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "only", " ", "right", " ", "block", " ", "has", " ", "base", " ", 
             "contacts"}], "*)"}], "\n", 
           RowBox[{
            RowBox[{"nextBlocksData", "=", 
             RowBox[{"correctAndBuildNextBlocksData", "[", 
              RowBox[{"rightBlock", ",", "nRow", ",", 
               RowBox[{"{", 
                RowBox[{"leftBlock", ",", "rightBlock"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"leftBlockLoads", ",", "rightBlockLoads"}], "}"}]}], 
              "]"}]}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"!", "leftHasBaseContact"}], "&&", 
            RowBox[{"!", "rightHasBaseContact"}]}], ",", "\n", 
           RowBox[{"(*", 
            RowBox[{
            "Check", " ", "which", " ", "block", " ", "really", " ", "has", 
             " ", "base", " ", "contacts"}], "*)"}], "\n", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"computeGlobalRot", "[", 
                RowBox[{"leftBlockLoads", ",", "rightBlockLoads"}], "]"}], 
               ">", "0"}], ",", "\n", 
              RowBox[{"(*", 
               RowBox[{"correct", " ", "towards", " ", "the", " ", "right"}], 
               "*)"}], "\n", 
              RowBox[{
               RowBox[{"nextBlocksData", "=", 
                RowBox[{"correctAndBuildNextBlocksData", "[", 
                 RowBox[{"rightBlock", ",", "nRow", ",", 
                  RowBox[{"{", 
                   RowBox[{"leftBlock", ",", "rightBlock"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"leftBlockLoads", ",", "rightBlockLoads"}], 
                   "}"}]}], "]"}]}], ";"}], ",", "\n", 
              RowBox[{"(*", 
               RowBox[{"correct", " ", "towards", " ", "the", " ", "left"}], 
               "*)"}], "\n", 
              RowBox[{
               RowBox[{"nextBlocksData", "=", 
                RowBox[{"correctAndBuildNextBlocksData", "[", 
                 RowBox[{"leftBlock", ",", "nRow", ",", 
                  RowBox[{"{", 
                   RowBox[{"leftBlock", ",", "rightBlock"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"leftBlockLoads", ",", "rightBlockLoads"}], 
                   "}"}]}], "]"}]}], ";"}]}], "\n", "]"}], ";"}]}], "\n", 
          "]"}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"(*", 
       RowBox[{"correction", " ", "wave", " ", "continues"}], "*)"}], "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dir", ">", "0"}], ",", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"left", " ", "solution", " ", "is", " ", "correct"}], ",", 
          " ", 
          RowBox[{"proceed", " ", "towards", " ", "the", " ", "right"}]}], 
         "*)"}], "\n", 
        RowBox[{
         RowBox[{"nextBlocksData", "=", 
          RowBox[{"correctAndBuildNextBlocksData", "[", 
           RowBox[{"rightBlock", ",", "nRow", ",", 
            RowBox[{"{", 
             RowBox[{"leftBlock", ",", "rightBlock"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"leftBlockLoads", ",", "rightBlockLoads"}], "}"}]}], 
           "]"}]}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dir", "<", "0"}], ",", "\n", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"right", " ", "solution", " ", "is", " ", "correct"}], ",", 
          " ", 
          RowBox[{"proceed", " ", "towards", " ", "the", " ", "left"}]}], 
         "*)"}], "\n", 
        RowBox[{
         RowBox[{"nextBlocksData", "=", 
          RowBox[{"correctAndBuildNextBlocksData", "[", 
           RowBox[{"leftBlock", ",", "nRow", ",", 
            RowBox[{"{", 
             RowBox[{"leftBlock", ",", "rightBlock"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"leftBlockLoads", ",", "rightBlockLoads"}], "}"}]}], 
           "]"}]}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
      "nextBlocksData"}]}], "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"startCorrectionWaves", "[", 
    RowBox[{"nRow_", ",", "unbalancedBlocksData_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "rowEqCheck", ",", "unbalancedBlocks", ",", "unbalancedBlockLoads", ",",
        "newUnbalancedBlocks", ",", "newUnbalancedBlockLoads", ",", 
       "directions", ",", "newDirections", ",", "nextBlocksData", ",", "j", 
       ",", "leftLoads", ",", "rightLoads"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"rowEqCheck", "=", "True"}], ";", "\n", 
      RowBox[{"unbalancedBlocks", "=", 
       RowBox[{"unbalancedBlocksData", "[", "\"\<blocks\>\"", "]"}]}], ";", 
      "\n", 
      RowBox[{"unbalancedBlockLoads", "=", 
       RowBox[{"unbalancedBlocksData", "[", "\"\<loads\>\"", "]"}]}], ";", 
      "\n", 
      RowBox[{"directions", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"Length", "[", "unbalancedBlocks", "]"}], "}"}]}], "]"}]}], 
      ";", "\n", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "unbalancedBlocks", "]"}], "!=", "0"}], "&&",
          "rowEqCheck"}], ",", "\n", 
        RowBox[{
         RowBox[{"newUnbalancedBlocks", "=", 
          RowBox[{"{", "}"}]}], ";", "\n", 
         RowBox[{"newUnbalancedBlockLoads", "=", 
          RowBox[{"{", "}"}]}], ";", "\n", 
         RowBox[{"newDirections", "=", 
          RowBox[{"{", "}"}]}], ";", "\n", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "<=", 
            RowBox[{"Length", "[", "unbalancedBlocks", "]"}]}], ",", 
           RowBox[{"j", "++"}], ",", "\n", 
           RowBox[{
            RowBox[{"nextBlocksData", "=", 
             RowBox[{"correctUnbalancedBlocks", "[", 
              RowBox[{"nRow", ",", 
               RowBox[{"unbalancedBlocks", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"unbalancedBlockLoads", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", 
               RowBox[{"directions", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", "\n", 
            RowBox[{"rowEqCheck", "=", 
             RowBox[{"nextBlocksData", "[", "\"\<eq_check\>\"", "]"}]}], ";", 
            "\n", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"nextBlocksData", "[", "\"\<blocks\>\"", "]"}], "]"}],
                "!=", "0"}], ",", "\n", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"newUnbalancedBlocks", ",", 
                 RowBox[{"nextBlocksData", "[", "\"\<blocks\>\"", "]"}]}], 
                "]"}], ";", "\n", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"newUnbalancedBlockLoads", ",", 
                 RowBox[{"nextBlocksData", "[", "\"\<loads\>\"", "]"}]}], 
                "]"}], ";", "\n", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"newDirections", ",", 
                 RowBox[{"nextBlocksData", "[", "\"\<dir\>\"", "]"}]}], "]"}],
                ";"}]}], "\n", "]"}], ";"}]}], "\n", "]"}], ";", "\n", 
         RowBox[{"(*", 
          RowBox[{"check", " ", "for", " ", "wave", " ", "collisions"}], 
          "*)"}], "\n", 
         RowBox[{"j", "=", "2"}], ";", "\n", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"j", "<=", 
            RowBox[{"Length", "[", "newUnbalancedBlocks", "]"}]}], ",", "\n", 
           
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"check", " ", "for", " ", "non"}], "-", 
             RowBox[{"staggared", " ", "wave", " ", "collision"}]}], "*)"}], 
           "\n", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"newUnbalancedBlocks", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "-", "1"}], "]"}], "]"}], "==", 
               RowBox[{"newUnbalancedBlocks", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ",", "\n", 
              RowBox[{
               RowBox[{"leftLoads", "=", 
                RowBox[{"newUnbalancedBlockLoads", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"j", "-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
               "\n", 
               RowBox[{"rightLoads", "=", 
                RowBox[{"newUnbalancedBlockLoads", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ";", "\n", 
               RowBox[{"newUnbalancedBlocks", "=", 
                RowBox[{"Drop", "[", 
                 RowBox[{"newUnbalancedBlocks", ",", 
                  RowBox[{"{", "j", "}"}]}], "]"}]}], ";", "\n", 
               RowBox[{"newUnbalancedBlockLoads", "=", 
                RowBox[{"Drop", "[", 
                 RowBox[{"newUnbalancedBlockLoads", ",", 
                  RowBox[{"{", "j", "}"}]}], "]"}]}], ";", "\n", 
               RowBox[{
                RowBox[{"newUnbalancedBlockLoads", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "-", "1"}], "]"}], "]"}], "=", 
                RowBox[{"{", 
                 RowBox[{"leftLoads", ",", "rightLoads"}], "}"}]}], ";", "\n", 
               RowBox[{"newDirections", "=", 
                RowBox[{"Drop", "[", 
                 RowBox[{"newDirections", ",", 
                  RowBox[{"{", "j", "}"}]}], "]"}]}], ";", "\n", 
               RowBox[{
                RowBox[{"newDirections", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", "-", "1"}], "]"}], "]"}], "=", "0"}], ";", 
               "\n", 
               RowBox[{"j", "--"}], ";"}], ",", "\n", 
              RowBox[{"(*", 
               RowBox[{
               "check", " ", "for", " ", "staggared", " ", "wave", " ", 
                "collision"}], "*)"}], "\n", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"newUnbalancedBlocks", "[", 
                   RowBox[{"[", 
                    RowBox[{
                    RowBox[{"j", "-", "1"}], ",", "2"}], "]"}], "]"}], "==", 
                  RowBox[{"newUnbalancedBlocks", "[", 
                   RowBox[{"[", 
                    RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ",", "\n", 
                 RowBox[{
                  RowBox[{"leftLoads", "=", 
                   RowBox[{"newUnbalancedBlockLoads", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"j", "-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
                  "\n", 
                  RowBox[{"rightLoads", "=", 
                   RowBox[{"newUnbalancedBlockLoads", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"j", "-", "1"}], ",", "2"}], "]"}], "]"}]}], ";", 
                  "\n", 
                  RowBox[{
                   RowBox[{"rightLoads", "[", 
                    RowBox[{"[", 
                    RowBox[{"17", ";;", "20"}], "]"}], "]"}], "=", 
                   RowBox[{"newUnbalancedBlockLoads", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", ",", "2", ",", 
                    RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";", "\n", 
                  RowBox[{"newUnbalancedBlocks", "=", 
                   RowBox[{"Drop", "[", 
                    RowBox[{"newUnbalancedBlocks", ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";", "\n", 
                  RowBox[{"newUnbalancedBlockLoads", "=", 
                   RowBox[{"Drop", "[", 
                    RowBox[{"newUnbalancedBlockLoads", ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";", "\n", 
                  RowBox[{
                   RowBox[{"newUnbalancedBlockLoads", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "1"}], "]"}], "]"}], "=", 
                   RowBox[{"{", 
                    RowBox[{"leftLoads", ",", "rightLoads"}], "}"}]}], ";", 
                  "\n", 
                  RowBox[{"newDirections", "=", 
                   RowBox[{"Drop", "[", 
                    RowBox[{"newDirections", ",", 
                    RowBox[{"{", "j", "}"}]}], "]"}]}], ";", "\n", 
                  RowBox[{
                   RowBox[{"newDirections", "[", 
                    RowBox[{"[", 
                    RowBox[{"j", "-", "1"}], "]"}], "]"}], "=", "1"}], ";", 
                  "\n", 
                  RowBox[{"j", "--"}], ";"}]}], "\n", "]"}], ";"}]}], "\n", 
             "]"}], ";", "\n", 
            RowBox[{"j", "++"}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
         RowBox[{"unbalancedBlocks", "=", "newUnbalancedBlocks"}], ";", "\n", 
         
         RowBox[{"unbalancedBlockLoads", "=", "newUnbalancedBlockLoads"}], 
         ";", "\n", 
         RowBox[{"directions", "=", "newDirections"}], ";"}]}], "\n", "]"}], 
      ";", "\n", "\n", "rowEqCheck"}]}], "\n", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.6825893575308743`*^9, {3.682592554542309*^9, 3.6825926642833652`*^9}, {
   3.682593188817528*^9, 3.682593196545197*^9}, {3.6825935055331984`*^9, 
   3.6825935343735743`*^9}, {3.682593716826456*^9, 3.682593791652087*^9}, {
   3.682594264116219*^9, 3.682594282736424*^9}, {3.682594794163311*^9, 
   3.6825948127380867`*^9}, {3.682594846249628*^9, 3.682594877460556*^9}, {
   3.682594942417708*^9, 3.682594963102756*^9}, {3.6825982621700897`*^9, 
   3.682598265082543*^9}, 3.682598305920547*^9, {3.6825985902239017`*^9, 
   3.6825985911254807`*^9}, 3.6826013752097673`*^9, {3.682601450771243*^9, 
   3.682601462233885*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveRow", "[", "nRow_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "j", ",", "blockSequence", ",", "blockLoads", ",", "contact", ",", 
       "unbalancedBlocksData", ",", "rowEqCheck"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"blockSequence", "=", 
       RowBox[{"findSolvableBlockSequence", "[", "nRow", "]"}]}], ";", "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", 
         RowBox[{"Length", "[", 
          RowBox[{"blockSequence", "[", "\"\<seq\>\"", "]"}], "]"}]}], ",", 
        RowBox[{"j", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"Do", "[", "\n", 
          RowBox[{
           RowBox[{
            RowBox[{"blockLoads", "=", 
             RowBox[{"getBlockLoads", "[", 
              RowBox[{"{", 
               RowBox[{"nRow", ",", "k"}], "}"}], "]"}]}], ";", "\n", 
            RowBox[{"contact", "=", 
             RowBox[{"contacts", "[", 
              RowBox[{"[", 
               RowBox[{"getBlockNum", "[", 
                RowBox[{"{", 
                 RowBox[{"nRow", ",", "k"}], "}"}], "]"}], "]"}], "]"}]}], 
            ";", "\n", 
            RowBox[{"blockLoads", "=", 
             RowBox[{"solveBlock", "[", 
              RowBox[{"blockLoads", ",", "contact", ",", 
               RowBox[{"{", 
                RowBox[{"nRow", ",", "k"}], "}"}], ",", 
               RowBox[{
                RowBox[{"blockSequence", "[", "\"\<dir\>\"", "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", "\n", 
            RowBox[{"updateStress", "[", 
             RowBox[{"blockLoads", ",", 
              RowBox[{"{", 
               RowBox[{"nRow", ",", "k"}], "}"}]}], "]"}], ";"}], ",", "\n", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{
              RowBox[{"blockSequence", "[", "\"\<seq\>\"", "]"}], "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "\n", "]"}], ";"}]}],
        "\n", "]"}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{"equilibrium", " ", "checks"}], "*)"}], "\n", 
      RowBox[{"unbalancedBlocksData", "=", 
       RowBox[{"checkRowEquilibrium", "[", 
        RowBox[{"nRow", ",", 
         RowBox[{"blockSequence", "[", "\"\<cri\>\"", "]"}]}], "]"}]}], ";", 
      "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"unbalancedBlocksData", "[", "\"\<eq_check\>\"", "]"}], "&&", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"unbalancedBlocksData", "[", "\"\<blocks\>\"", "]"}], 
           "]"}], "\[NotEqual]", "0"}]}], ",", "\n", 
        RowBox[{"(*", 
         RowBox[{
         "start", " ", "correcting", " ", "unbalanced", " ", "blocks"}], 
         "*)"}], "\n", 
        RowBox[{
         RowBox[{"rowEqCheck", "=", 
          RowBox[{"startCorrectionWaves", "[", 
           RowBox[{"nRow", ",", "unbalancedBlocksData"}], "]"}]}], ";"}], ",",
         "\n", 
        RowBox[{"(*", 
         RowBox[{"no", " ", "block", " ", "needs", " ", "correction"}], 
         "*)"}], "\n", 
        RowBox[{
         RowBox[{"rowEqCheck", "=", 
          RowBox[{"unbalancedBlocksData", "[", "\"\<eq_check\>\"", "]"}]}], 
         ";"}]}], "\n", "]"}], ";", "\n", "\n", "rowEqCheck"}]}], "\n", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682572084991914*^9, 3.682572119925264*^9}, {
   3.682572156063777*^9, 3.6825721628268623`*^9}, {3.6825724555820427`*^9, 
   3.682572458181802*^9}, {3.682588598701243*^9, 3.682588638858243*^9}, 
   3.68258877157288*^9, {3.6825889578688307`*^9, 3.682588969426014*^9}, {
   3.6825890533986273`*^9, 3.682589084836463*^9}, {3.68258919251446*^9, 
   3.682589230848469*^9}, {3.68258932359753*^9, 3.68258932587005*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"transferContactActionsBelow", "[", "nRow_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j", ",", "totalBlocksInRowBelow"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"totalBlocksInRowBelow", "=", 
       RowBox[{"getTotalBlocksInRow", "[", 
        RowBox[{"nRow", "+", "1"}], "]"}]}], ";", "\n", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "transfer", " ", "base", " ", "reactions", " ", "of", " ", "blocks", 
         " ", "in", " ", "row", " ", "nRow", " ", "to", " ", "the", " ", 
         "blocks", " ", "in", " ", "row", " ", "nRow"}], "+", "1"}], "*)"}], 
      "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", "totalBlocksInRowBelow"}], ",", 
        RowBox[{"j", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"updateStress", "[", 
          RowBox[{
           RowBox[{"getBlockLoads", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nRow", "+", "1"}], ",", "j"}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"nRow", "+", "1"}], ",", "j"}], "}"}]}], "]"}], ";"}]}], 
       "\n", "]"}], ";"}]}], "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveWall", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "i", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"eqCheck", "=", "True"}], ";", "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{
         RowBox[{"i", "<=", "nely"}], "&&", "eqCheck"}], ",", 
        RowBox[{"i", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"eqCheck", "=", 
          RowBox[{"solveRow", "[", "i", "]"}]}], ";", "\n", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "!=", "nely"}], ",", "\n", 
           RowBox[{
            RowBox[{"transferContactActionsBelow", "[", "i", "]"}], ";"}]}], 
          "\n", "]"}], ";"}]}], "\n", "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"displayWall", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "blocks", ",", "stressAvg", ",", "interfaces", ",", "frictionRatio", 
       ",", "blockLoads", ",", "ptBL", ",", "ptBR", ",", "ptTR", ",", "i", 
       ",", "j", ",", "totalBlocksInRow"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"blocks", "=", 
       RowBox[{"{", "}"}]}], ";", " ", 
      RowBox[{"stressAvg", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"interfaces", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "<=", "nely"}], ",", 
        RowBox[{"i", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{"totalBlocksInRow", "=", 
          RowBox[{"getTotalBlocksInRow", "[", "i", "]"}]}], ";", "\n", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", "1"}], ",", 
           RowBox[{"j", "<=", "totalBlocksInRow"}], ",", 
           RowBox[{"j", "++"}], ",", "\n", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"isBlockOnLeftEdge", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j"}], "}"}], "]"}], "||", 
                 RowBox[{"isBlockOnRightEdge", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j"}], "}"}], "]"}]}], ")"}]}], ",", 
              "\n", 
              RowBox[{
               RowBox[{"ptBL", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", " ", "-", "1"}], ")"}], "b"}], "-", 
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], 
                    RowBox[{"b", "/", "2"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"nely", "-", "i"}], ")"}], "h"}]}], "}"}]}], ";", 
               
               RowBox[{"(*", 
                RowBox[{"bottom", " ", "left", " ", 
                 RowBox[{"vertex", "'"}], "s", " ", "coordinates", " ", "of", 
                 " ", "the", " ", "current", " ", "block"}], "*)"}], "\n", 
               RowBox[{"ptBR", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"j", " ", "b"}], "-", 
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], 
                    RowBox[{"b", "/", "2"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"nely", "-", "i"}], ")"}], "h"}]}], "}"}]}], ";", 
               
               RowBox[{"(*", 
                RowBox[{"bottom", " ", "right", " ", 
                 RowBox[{"vertex", "'"}], "s", " ", "coordinates", " ", "of", 
                 " ", "the", " ", "current", " ", "block"}], "*)"}], "\n", 
               RowBox[{"ptTR", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"j", " ", "b"}], "-", 
                   RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], 
                    RowBox[{"b", "/", "2"}]}]}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"nely", "-", "i", "+", "1"}], ")"}], "h"}]}], 
                 "}"}]}], ";"}], 
              RowBox[{"(*", 
               RowBox[{"top", " ", "right", " ", 
                RowBox[{"vertex", "'"}], "s", " ", "coordinates", " ", "of", 
                " ", "the", " ", "current", " ", "block"}], "*)"}], ",", "\n", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"isBlockOnLeftEdge", "[", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j"}], "}"}], "]"}], ",", "\n", 
                 RowBox[{"(*", 
                  RowBox[{
                  "block", " ", "on", " ", "the", " ", "left", " ", "edge"}], 
                  "*)"}], "\n", 
                 RowBox[{
                  RowBox[{"ptBL", "=", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nely", "-", "i"}], ")"}], "h"}]}], "}"}]}], ";", 
                  "\n", 
                  RowBox[{"ptBR", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b", "-", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], 
                    RowBox[{"b", "/", "2"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nely", "-", "i"}], ")"}], "h"}]}], "}"}]}], ";", 
                  "\n", 
                  RowBox[{"ptTR", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b", "-", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], 
                    RowBox[{"b", "/", "2"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nely", "-", "i", "+", "1"}], ")"}], "h"}]}], 
                    "}"}]}], ";"}], ",", "\n", 
                 RowBox[{"(*", 
                  RowBox[{
                  "block", " ", "on", " ", "the", " ", "right", " ", "edge"}],
                   "*)"}], "\n", 
                 RowBox[{
                  RowBox[{"ptBL", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"b", 
                    RowBox[{"(", 
                    RowBox[{"nelx", "-", "2"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"Mod", "[", 
                    RowBox[{"i", ",", "2"}], "]"}], 
                    RowBox[{"b", "/", "2"}]}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nely", "-", "i"}], ")"}], "h"}]}], "}"}]}], ";", 
                  "\n", 
                  RowBox[{"ptBR", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b", 
                    RowBox[{"(", 
                    RowBox[{"nelx", "-", "1"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nely", "-", "i"}], ")"}], "h"}]}], "}"}]}], ";", 
                  "\n", 
                  RowBox[{"ptTR", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"b", 
                    RowBox[{"(", 
                    RowBox[{"nelx", "-", "1"}], ")"}]}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"nely", "-", "i", "+", "1"}], ")"}], "h"}]}], 
                    "}"}]}], ";"}]}], "\n", "]"}], ";"}]}], "\n", "]"}], ";", 
            "\n", "\n", 
            RowBox[{"(*", 
             RowBox[{
             "create", " ", "graphical", " ", "elements", " ", "colored", " ",
               "using", " ", "stress", " ", "measure"}], "*)"}], "\n", 
            RowBox[{"blockLoads", "=", 
             RowBox[{"getBlockLoads", "[", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}], "]"}]}], ";", "\n", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"stressAvg", ",", 
              RowBox[{"Norm", "[", "blockLoads", "]"}]}], "]"}], ";", 
            RowBox[{"(*", 
             RowBox[{
             "stress", " ", "measure", " ", "defined", " ", "as", " ", "the", 
              " ", "norm", " ", 
              RowBox[{"of", " ", "'"}], 
              RowBox[{"blockLoads", "'"}]}], "*)"}], "\n", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"blocks", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", 
                 RowBox[{"{", "Black", "}"}], "]"}], ",", 
                RowBox[{"GrayLevel", "[", "0.5", "]"}], ",", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{"ptBL", ",", "ptTR"}], "]"}]}], "}"}]}], "]"}], ";", 
            "\n", "\n", 
            RowBox[{"frictionRatio", "=", 
             RowBox[{"Piecewise", "[", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"Total", "[", 
                    RowBox[{"blockLoads", "[", 
                    RowBox[{"[", 
                    RowBox[{"12", ";;", "16", ";;", "2"}], "]"}], "]"}], 
                    "]"}], "]"}], "/", 
                  RowBox[{"(", 
                   RowBox[{"\[Mu]", " ", 
                    RowBox[{"Total", "[", 
                    RowBox[{"blockLoads", "[", 
                    RowBox[{"[", 
                    RowBox[{"11", ";;", "15", ";;", "2"}], "]"}], "]"}], 
                    "]"}]}], ")"}]}], ",", 
                 RowBox[{
                  RowBox[{"Total", "[", 
                   RowBox[{"blockLoads", "[", 
                    RowBox[{"[", 
                    RowBox[{"11", ";;", "15", ";;", "2"}], "]"}], "]"}], 
                   "]"}], ">", "0"}]}], "}"}], "}"}], "]"}]}], ";", "\n", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"interfaces", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"RGBColor", "[", 
                 RowBox[{"frictionRatio", ",", "0", ",", "0"}], "]"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{"ptBL", ",", "ptBR"}], "}"}], "]"}]}], "}"}]}], 
             "]"}], ";"}]}], 
          RowBox[{"(*", 
           RowBox[{"friction", " ", "on", " ", "the", " ", "base"}], "*)"}], 
          "\n", "]"}], ";"}]}], "\n", "]"}], ";", "\n", 
      RowBox[{
       RowBox[{"blocks", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "2"}], "]"}], "]"}], "=", 
       RowBox[{"GrayLevel", "/@", 
        RowBox[{"(", 
         RowBox[{"stressAvg", "/", 
          RowBox[{"Max", "[", "stressAvg", "]"}]}], ")"}]}]}], ";", 
      RowBox[{"(*", 
       RowBox[{
       "assign", " ", "GrayLevel", " ", "based", " ", "on", " ", "strees"}], 
       "*)"}], "\n", "\n", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Graphics", "[", "blocks", "]"}], ",", 
        RowBox[{"Graphics", "[", "interfaces", "]"}]}], "]"}]}]}], "]"}]}], 
  ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Problem\[CloseCurlyQuote]s stuff", "Section",
 CellChangeTimes->{{3.681800742754244*^9, 3.6818007465997057`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"initStressVectors", "[", 
    RowBox[{"$nelx_", ",", "$nely_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"EvenQ", "[", "$nely", "]"}], ",", "\n", 
        RowBox[{
         RowBox[{"totalBlocks", "=", 
          RowBox[{"getBlockNum", "[", 
           RowBox[{"{", 
            RowBox[{"$nely", ",", 
             RowBox[{"$nelx", "-", "1"}]}], "}"}], "]"}]}], ";"}], ",", "\n", 
        
        RowBox[{
         RowBox[{"totalBlocks", "=", 
          RowBox[{"getBlockNum", "[", 
           RowBox[{"{", 
            RowBox[{"$nely", ",", "$nelx"}], "}"}], "]"}]}], ";"}]}], "\n", 
       "]"}], ";", "\n", 
      RowBox[{"\[Sigma]v", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
           ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", "totalBlocks", "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"\[Sigma]h", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"totalBlocks", "+", "$nely"}], "}"}]}], "]"}]}], ";"}]}], 
    "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setProblemProperties", "[", 
    RowBox[{
    "$nelx_", ",", "$nely_", ",", "$b_", ",", "$h_", ",", "$P_", ",", 
     "$\[Mu]_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"nelx", "=", "$nelx"}], ";", 
      RowBox[{"nely", "=", "$nely"}], ";", "\n", 
      RowBox[{"b", "=", "$b"}], ";", 
      RowBox[{"h", "=", "$h"}], ";", "\n", 
      RowBox[{"P", "=", "$P"}], ";", 
      RowBox[{"\[Mu]", "=", "$\[Mu]"}], ";", "\n", 
      RowBox[{"initStressVectors", "[", 
       RowBox[{"nelx", ",", "nely"}], "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"generateContacts", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{"contacts", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}], ",", "totalBlocks"}], "]"}]}]}], 
    "\n", "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"setBoundaryConditions", "[", "$loads_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"loads", "=", "$loads"}], ";"}]}], "\n", "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"applyLoads", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "j", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"j", "=", "1"}], ",", 
        RowBox[{"j", "<=", "nelx"}], ",", 
        RowBox[{"j", "++"}], ",", "\n", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Sigma]v", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"loads", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"6", 
                 RowBox[{"(", 
                  RowBox[{"j", "-", "1"}], ")"}]}], "+", "1"}], ";;", 
               RowBox[{"6", "j"}]}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
             "}"}]}], "]"}]}], ";"}]}], "\n", "]"}], ";"}]}], "\n", "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"solveProblem", "[", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"applyLoads", "[", "]"}], ";", "\n", 
      RowBox[{"solveWall", "[", "]"}], ";", "\n", 
      RowBox[{"displayWall", "[", "]"}]}]}], "\n", "]"}]}], ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Section",
 CellChangeTimes->{{3.68180082612658*^9, 3.681800827648224*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Properties", " ", "initialization"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"nelx", "=", "9"}], ";", 
    RowBox[{"nely", "=", "10"}], ";", 
    RowBox[{"b", "=", "2"}], ";", 
    RowBox[{"h", "=", "1"}], ";", 
    RowBox[{"P", "=", "0.1"}], ";", 
    RowBox[{"\[Mu]", "=", "0.8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setProblemProperties", "[", 
     RowBox[{
     "nelx", ",", "nely", ",", "b", ",", "h", ",", "P", ",", "\[Mu]"}], "]"}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.681800897819695*^9, 3.681800925859068*^9}, {
   3.6818061755977163`*^9, 3.681806198491375*^9}, {3.681807249128894*^9, 
   3.681807252358502*^9}, {3.681820919595581*^9, 3.6818209238880463`*^9}, {
   3.681834187131278*^9, 3.681834192198721*^9}, {3.681837748710472*^9, 
   3.6818377587953987`*^9}, {3.681887377599655*^9, 3.68188738539964*^9}, {
   3.681907207986231*^9, 3.681907211109733*^9}, {3.6819072904716043`*^9, 
   3.681907318492744*^9}, {3.68190737181026*^9, 3.6819073739948874`*^9}, {
   3.681984744350996*^9, 3.681984749121591*^9}, 3.681987871919908*^9, {
   3.681988934471201*^9, 3.681988937366481*^9}, {3.6820480258573427`*^9, 
   3.682048030721792*^9}, 3.682052922168651*^9, {3.682053220907321*^9, 
   3.682053223142548*^9}, {3.682424247100017*^9, 3.6824242496613913`*^9}, 
   3.682507450225408*^9, {3.682507924929326*^9, 3.682507943029509*^9}, {
   3.6825174933841753`*^9, 3.682517498412507*^9}, {3.6825728335487413`*^9, 
   3.682572833781467*^9}, {3.6825733902095013`*^9, 3.682573412597357*^9}, {
   3.682580370176339*^9, 3.68258037027523*^9}, 3.682589864366663*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Contacts", " ", "generation"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"generateContacts", "[", "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.681806202871662*^9, 3.681806247462635*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Loads", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}], ",", 
       RowBox[{"{", "nelx", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "10", ",", "25", ",", "0", ",", "0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "10", ",", 
       RowBox[{"-", "5"}], ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"[", "5", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "10", ",", "10", ",", "0", ",", "0"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"[", "6", "]"}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "10", ",", 
       RowBox[{"-", "35"}], ",", "0", ",", "0"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"Flatten", "[", "p", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"setBoundaryConditions", "[", "p", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6818009687794867`*^9, 3.681800979448945*^9}, {
   3.6818209671377068`*^9, 3.6818209960043983`*^9}, 3.681837178889175*^9, 
   3.6818374667603807`*^9, {3.681837686824499*^9, 3.681837687774103*^9}, {
   3.6818873972149973`*^9, 3.681887429524086*^9}, {3.681887749187104*^9, 
   3.681887753782529*^9}, {3.681887834659442*^9, 3.6818878786849947`*^9}, {
   3.681888068135314*^9, 3.681888115918132*^9}, {3.68188819101409*^9, 
   3.6818882060660963`*^9}, {3.6818882730128403`*^9, 
   3.6818883016188927`*^9}, {3.6818884832154408`*^9, 3.681888489160434*^9}, 
   3.681888544444072*^9, {3.681888688040085*^9, 3.681888691449609*^9}, {
   3.68188874790994*^9, 3.6818887498530273`*^9}, {3.681889133194478*^9, 
   3.6818891359854507`*^9}, {3.68188922280212*^9, 3.681889245627615*^9}, {
   3.681889311016531*^9, 3.681889387720848*^9}, 3.681889482262664*^9, 
   3.6818899527251*^9, 3.6818900546432533`*^9, 3.68189009240012*^9, 
   3.681890128978732*^9, {3.681890181382146*^9, 3.681890182929777*^9}, 
   3.6818903251845493`*^9, 3.6818904871063766`*^9, 3.681900633297118*^9, {
   3.681901080852096*^9, 3.681901085298888*^9}, 3.681901134165181*^9, 
   3.6819024493535147`*^9, {3.681902489674528*^9, 3.681902498194981*^9}, {
   3.681902542297921*^9, 3.6819025961872797`*^9}, {3.681902641126587*^9, 
   3.681902659215238*^9}, {3.6819032762766237`*^9, 3.6819032774648657`*^9}, 
   3.681903370335958*^9, 3.6819040617848663`*^9, {3.681906192867955*^9, 
   3.6819062082954206`*^9}, {3.681907180186204*^9, 3.681907284318181*^9}, {
   3.681907337372348*^9, 3.681907359370723*^9}, {3.681907401993403*^9, 
   3.681907472290341*^9}, 3.681984775270701*^9, 3.6819848078613043`*^9, {
   3.6819889646652813`*^9, 3.681988974225561*^9}, {3.681989025847781*^9, 
   3.681989044890935*^9}, {3.6819891814109907`*^9, 3.6819891823458767`*^9}, {
   3.6820480415836763`*^9, 3.682048065288439*^9}, {3.682048148401375*^9, 
   3.682048157546109*^9}, {3.682048766847742*^9, 3.682048844926646*^9}, {
   3.682052633390891*^9, 3.682052655228097*^9}, {3.6820528194746017`*^9, 
   3.6820528760431128`*^9}, {3.6820529409237537`*^9, 
   3.6820529463714027`*^9}, {3.6820530610320683`*^9, 3.682053075621449*^9}, {
   3.6820532287843237`*^9, 3.6820532534343987`*^9}, {3.6820532945514097`*^9, 
   3.682053295342679*^9}, {3.682053907916402*^9, 3.682053957988512*^9}, 
   3.6820540393831863`*^9, {3.6824242737177067`*^9, 3.682424282008898*^9}, {
   3.6824247225787573`*^9, 3.682424722662636*^9}, {3.682507109785618*^9, 
   3.682507109886766*^9}, {3.682517508501645*^9, 3.682517552092557*^9}, {
   3.6825310999687138`*^9, 3.68253112707778*^9}, {3.68253116031448*^9, 
   3.682531160383572*^9}, 3.6825728112886057`*^9, {3.68257290498316*^9, 
   3.6825729305117893`*^9}, {3.6825729859213448`*^9, 3.682572986152893*^9}, {
   3.682573065665861*^9, 3.682573095988763*^9}, {3.682573427180223*^9, 
   3.68257354769241*^9}, {3.682587826506764*^9, 3.682587832059235*^9}, {
   3.682589710885511*^9, 3.682589711715488*^9}, {3.682590974623313*^9, 
   3.6825910212041407`*^9}, {3.682591116833716*^9, 3.682591120552784*^9}, {
   3.682591216455307*^9, 3.6825912167577343`*^9}, {3.682591376011335*^9, 
   3.6825914238887997`*^9}, 3.682591496152803*^9, 3.682591562642948*^9, 
   3.682591594959013*^9, {3.6825917913767023`*^9, 3.682591793808426*^9}, {
   3.6825950380612288`*^9, 3.682595040901701*^9}, {3.682596297626833*^9, 
   3.682596297914116*^9}, {3.682596333961825*^9, 3.682596338350937*^9}, {
   3.6825963770101433`*^9, 3.682596377218845*^9}, {3.6825964537734823`*^9, 
   3.682596453977727*^9}, {3.682598745491788*^9, 3.682598768486238*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Solution", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"solveProblem", "[", "]"}]}]], "Input",
 CellChangeTimes->{{3.681800985789946*^9, 3.681801028265375*^9}, 
   3.681813056006426*^9, 3.681820561835126*^9, {3.68198897809053*^9, 
   3.681988981748167*^9}}],

Cell[BoxData[
 GraphicsBox[{{
    {GrayLevel[0.0007685240883564151], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0, 9}]}, 
    {GrayLevel[0.726939878760113], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1, 9}, {3, 10}]}, 
    {GrayLevel[0.4664657609602313], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3, 9}, {5, 10}]}, 
    {GrayLevel[0.1919176843234128], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5, 9}, {7, 10}]}, 
    {GrayLevel[0.697876882875213], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7, 9}, {9, 10}]}, 
    {GrayLevel[1.], EdgeForm[GrayLevel[0]], RectangleBox[{9, 9}, {11, 10}]}, 
    {GrayLevel[0.002173714377528122], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11, 9}, {13, 10}]}, 
    {GrayLevel[0.002173714377528122], EdgeForm[GrayLevel[0]], 
     RectangleBox[{13, 9}, {15, 10}]}, 
    {GrayLevel[0.0007685240883564151], EdgeForm[GrayLevel[0]], 
     RectangleBox[{15, 9}]}, 
    {GrayLevel[0.0028755538321124895`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0, 8}, {2, 9}]}, 
    {GrayLevel[0.4202869039295886], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2, 8}, {4, 9}]}, 
    {GrayLevel[0.22225859581270943`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4, 8}, {6, 9}]}, 
    {GrayLevel[0.3642937282963967], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6, 8}, {8, 9}]}, 
    {GrayLevel[0.3642937282963967], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8, 8}, {10, 9}]}, 
    {GrayLevel[0.003764983743021663], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10, 8}, {12, 9}]}, 
    {GrayLevel[0.002173714377528122], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12, 8}, {14, 9}]}, 
    {GrayLevel[0.004627127748011949], EdgeForm[GrayLevel[0]], 
     RectangleBox[{14, 8}, {16, 9}]}, 
    {GrayLevel[0.004414834770936954], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0, 7}]}, 
    {GrayLevel[0.14310462099491633`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1, 7}, {3, 8}]}, 
    {GrayLevel[0.34447949425207774`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3, 7}, {5, 8}]}, 
    {GrayLevel[0.435675983977382], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5, 7}, {7, 8}]}, 
    {GrayLevel[0.3084661042769842], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7, 7}, {9, 8}]}, 
    {GrayLevel[0.003764983743021663], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9, 7}, {11, 8}]}, 
    {GrayLevel[0.003764983743021663], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11, 7}, {13, 8}]}, 
    {GrayLevel[0.007381432825808919], EdgeForm[GrayLevel[0]], 
     RectangleBox[{13, 7}, {15, 8}]}, 
    {GrayLevel[0.0031453203884394647`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{15, 7}]}, 
    {GrayLevel[0.006521143132584366], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0, 6}, {2, 7}]}, 
    {GrayLevel[0.11824726147843521`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2, 6}, {4, 7}]}, 
    {GrayLevel[0.6087860092245392], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4, 6}, {6, 7}]}, 
    {GrayLevel[0.3803981542986496], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6, 6}, {8, 7}]}, 
    {GrayLevel[0.16946165591853846`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8, 6}, {10, 7}]}, 
    {GrayLevel[0.007837438646390932], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10, 6}, {12, 7}]}, 
    {GrayLevel[0.0112491031658877], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12, 6}, {14, 7}]}, 
    {GrayLevel[0.0047530589881875284`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{14, 6}, {16, 7}]}, 
    {GrayLevel[0.008312859020994816], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0, 5}]}, 
    {GrayLevel[0.11678871448313903`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1, 5}, {3, 6}]}, 
    {GrayLevel[0.2844063902004935], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3, 5}, {5, 6}]}, 
    {GrayLevel[0.6542109764771744], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5, 5}, {7, 6}]}, 
    {GrayLevel[0.15713415315710125`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7, 5}, {9, 6}]}, 
    {GrayLevel[0.0015370481767128302`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9, 5}, {11, 6}]}, 
    {GrayLevel[0.010079098927684863`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11, 5}, {13, 6}]}, 
    {GrayLevel[0.015423227297105484`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{13, 5}, {15, 6}]}, 
    {GrayLevel[0.005802229626608323], EdgeForm[GrayLevel[0]], 
     RectangleBox[{15, 5}]}, 
    {GrayLevel[0.01036795678703855], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0, 4}, {2, 5}]}, 
    {GrayLevel[0.297792482346778], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2, 4}, {4, 5}]}, 
    {GrayLevel[0.5711048174485285], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4, 4}, {6, 5}]}, 
    {GrayLevel[0.13629629419921924`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6, 4}, {8, 5}]}, 
    {GrayLevel[0.003436944207821998], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8, 4}, {10, 5}]}, 
    {GrayLevel[0.013918563216006576`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10, 4}, {12, 5}]}, 
    {GrayLevel[0.018891472654257734`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12, 4}, {14, 5}]}, 
    {GrayLevel[0.010875362623628135`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{14, 4}, {16, 5}]}, 
    {GrayLevel[0.00277095300699827], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0, 3}]}, 
    {GrayLevel[0.0775361593567551], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1, 3}, {3, 4}]}, 
    {GrayLevel[0.4995977230405267], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3, 3}, {5, 4}]}, 
    {GrayLevel[0.3394257535659426], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5, 3}, {7, 4}]}, 
    {GrayLevel[0.1284658799978351], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7, 3}, {9, 4}]}, 
    {GrayLevel[0.015523425651211654`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9, 3}, {11, 4}]}, 
    {GrayLevel[0.002173714377528122], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11, 3}, {13, 4}]}, 
    {GrayLevel[0.024390804345559073`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{13, 3}, {15, 4}]}, 
    {GrayLevel[0.0065662726892839526`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{15, 3}]}, 
    {GrayLevel[0.004138628874052093], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0, 2}, {2, 3}]}, 
    {GrayLevel[0.354450622137502], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2, 2}, {4, 3}]}, 
    {GrayLevel[0.5427750989323762], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4, 2}, {6, 3}]}, 
    {GrayLevel[0.08447133690113176], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6, 2}, {8, 3}]}, 
    {GrayLevel[0.09410207942180361], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8, 2}, {10, 3}]}, 
    {GrayLevel[0.01697725201260265], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10, 2}, {12, 3}]}, 
    {GrayLevel[0.012029304727376993`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12, 2}, {14, 3}]}, 
    {GrayLevel[0.026047751898171316`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{14, 2}, {16, 3}]}, 
    {GrayLevel[0.0035218198082901998`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0, 1}]}, 
    {GrayLevel[0.004799431393506765], EdgeForm[GrayLevel[0]], 
     RectangleBox[{1, 1}, {3, 2}]}, 
    {GrayLevel[0.34213169506012475`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{3, 1}, {5, 2}]}, 
    {GrayLevel[0.617465054708386], EdgeForm[GrayLevel[0]], 
     RectangleBox[{5, 1}, {7, 2}]}, 
    {GrayLevel[0.12246818572196001`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{7, 1}, {9, 2}]}, 
    {GrayLevel[0.0015370481767128302`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{9, 1}, {11, 2}]}, 
    {GrayLevel[0.019074266251171503`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{11, 1}, {13, 2}]}, 
    {GrayLevel[0.030288527868436246`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{13, 1}, {15, 2}]}, 
    {GrayLevel[0.009246274247884526], EdgeForm[GrayLevel[0]], 
     RectangleBox[{15, 1}]}, 
    {GrayLevel[0.008728755718631584], EdgeForm[GrayLevel[0]], 
     RectangleBox[{0, 0}, {2, 1}]}, 
    {GrayLevel[0.14687295871714445`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{2, 0}, {4, 1}]}, 
    {GrayLevel[0.7284677349271398], EdgeForm[GrayLevel[0]], 
     RectangleBox[{4, 0}, {6, 1}]}, 
    {GrayLevel[0.18982643099919994`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{6, 0}, {8, 1}]}, 
    {GrayLevel[0.0025489060434281704`], EdgeForm[GrayLevel[0]], 
     RectangleBox[{8, 0}, {10, 1}]}, 
    {GrayLevel[0.02157349921117662], EdgeForm[GrayLevel[0]], 
     RectangleBox[{10, 0}, {12, 1}]}, 
    {GrayLevel[0.03436299720356665], EdgeForm[GrayLevel[0]], 
     RectangleBox[{12, 0}, {14, 1}]}, 
    {GrayLevel[0.01071119678416485], EdgeForm[GrayLevel[0]], 
     RectangleBox[{14, 0}, {16, 1}]}}, {
    {RGBColor[0., 0, 0], LineBox[{{0, 9}, {1, 9}}]}, 
    {RGBColor[1., 0, 0], LineBox[{{1, 9}, {3, 9}}]}, 
    {RGBColor[0.3910891089108911, 0, 0], LineBox[{{3, 9}, {5, 9}}]}, 
    {RGBColor[1., 0, 0], LineBox[{{5, 9}, {7, 9}}]}, 
    {RGBColor[1., 0, 0], LineBox[{{7, 9}, {9, 9}}]}, 
    {RGBColor[1., 0, 0], LineBox[{{9, 9}, {11, 9}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{11, 9}, {13, 9}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{13, 9}, {15, 9}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{15, 9}, {16, 9}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{0, 8}, {2, 8}}]}, 
    {RGBColor[0.8741635033068527, 0, 0], LineBox[{{2, 8}, {4, 8}}]}, 
    {RGBColor[0.36838620167749253`, 0, 0], LineBox[{{4, 8}, {6, 8}}]}, 
    {RGBColor[0.9901960784313725, 0, 0], LineBox[{{6, 8}, {8, 8}}]}, 
    {RGBColor[0.9901960784313725, 0, 0], LineBox[{{8, 8}, {10, 8}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{10, 8}, {12, 8}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{12, 8}, {14, 8}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{14, 8}, {16, 8}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{0, 7}, {1, 7}}]}, 
    {RGBColor[0.032022828154724195`, 0, 0], LineBox[{{1, 7}, {3, 7}}]}, 
    {RGBColor[0.9999999999999999, 0, 0], LineBox[{{3, 7}, {5, 7}}]}, 
    {RGBColor[0.2876878596950604, 0, 0], LineBox[{{5, 7}, {7, 7}}]}, 
    {RGBColor[0.9805825242718447, 0, 0], LineBox[{{7, 7}, {9, 7}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{9, 7}, {11, 7}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{11, 7}, {13, 7}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{13, 7}, {15, 7}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{15, 7}, {16, 7}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{0, 6}, {2, 6}}]}, 
    {RGBColor[0.07731715934518892, 0, 0], LineBox[{{2, 6}, {4, 6}}]}, 
    {RGBColor[0.19293083885267967`, 0, 0], LineBox[{{4, 6}, {6, 6}}]}, 
    {RGBColor[1., 0, 0], LineBox[{{6, 6}, {8, 6}}]}, 
    {RGBColor[0.08259911894273139, 0, 0], LineBox[{{8, 6}, {10, 6}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{10, 6}, {12, 6}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{12, 6}, {14, 6}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{14, 6}, {16, 6}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{0, 5}, {1, 5}}]}, 
    {RGBColor[0.03252273371287256, 0, 0], LineBox[{{1, 5}, {3, 5}}]}, 
    {RGBColor[0.2022284282171057, 0, 0], LineBox[{{3, 5}, {5, 5}}]}, 
    {RGBColor[0.31072822959523183`, 0, 0], LineBox[{{5, 5}, {7, 5}}]}, 
    {RGBColor[0.22536195873664983`, 0, 0], LineBox[{{7, 5}, {9, 5}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{9, 5}, {11, 5}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{11, 5}, {13, 5}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{13, 5}, {15, 5}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{15, 5}, {16, 5}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{0, 4}, {2, 4}}]}, 
    {RGBColor[0.14725995513593013`, 0, 0], LineBox[{{2, 4}, {4, 4}}]}, 
    {RGBColor[0.2761840256844052, 0, 0], LineBox[{{4, 4}, {6, 4}}]}, 
    {RGBColor[0.22134179980924218`, 0, 0], LineBox[{{6, 4}, {8, 4}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{8, 4}, {10, 4}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{10, 4}, {12, 4}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{12, 4}, {14, 4}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{14, 4}, {16, 4}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{0, 3}, {1, 3}}]}, 
    {RGBColor[0.1237653163308776, 0, 0], LineBox[{{1, 3}, {3, 3}}]}, 
    {RGBColor[0.09333555250916917, 0, 0], LineBox[{{3, 3}, {5, 3}}]}, 
    {RGBColor[0.27386393730219916`, 0, 0], LineBox[{{5, 3}, {7, 3}}]}, 
    {RGBColor[0.21189211301898017`, 0, 0], LineBox[{{7, 3}, {9, 3}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{9, 3}, {11, 3}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{11, 3}, {13, 3}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{13, 3}, {15, 3}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{15, 3}, {16, 3}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{0, 2}, {2, 2}}]}, 
    {RGBColor[0.04843464298639938, 0, 0], LineBox[{{2, 2}, {4, 2}}]}, 
    {RGBColor[0.18569781268471744`, 0, 0], LineBox[{{4, 2}, {6, 2}}]}, 
    {RGBColor[0.2859385777281951, 0, 0], LineBox[{{6, 2}, {8, 2}}]}, 
    {RGBColor[0.11988936244478629`, 0, 0], LineBox[{{8, 2}, {10, 2}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{10, 2}, {12, 2}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{12, 2}, {14, 2}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{14, 2}, {16, 2}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{0, 1}, {1, 1}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{1, 1}, {3, 1}}]}, 
    {RGBColor[0.048105223096374, 0, 0], LineBox[{{3, 1}, {5, 1}}]}, 
    {RGBColor[0.18782065270405277`, 0, 0], LineBox[{{5, 1}, {7, 1}}]}, 
    {RGBColor[0.1874376232580118, 0, 0], LineBox[{{7, 1}, {9, 1}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{9, 1}, {11, 1}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{11, 1}, {13, 1}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{13, 1}, {15, 1}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{15, 1}, {16, 1}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{0, 0}, {2, 0}}]}, 
    {RGBColor[0.04663683853823652, 0, 0], LineBox[{{2, 0}, {4, 0}}]}, 
    {RGBColor[0.14234819542878743`, 0, 0], LineBox[{{4, 0}, {6, 0}}]}, 
    {RGBColor[0.18541970053803117`, 0, 0], LineBox[{{6, 0}, {8, 0}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{8, 0}, {10, 0}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{10, 0}, {12, 0}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{12, 0}, {14, 0}}]}, 
    {RGBColor[0., 0, 0], LineBox[{{14, 0}, {16, 0}}]}}},
  ImageSize->{1162., Automatic}]], "Output",
 CellChangeTimes->{
  3.682507401658945*^9, 3.682507456596232*^9, 3.682507865014105*^9, {
   3.682507928147585*^9, 3.682507946328947*^9}, {3.682508021533242*^9, 
   3.682508029968954*^9}, 3.682508640012849*^9, {3.682517450726118*^9, 
   3.682517474124714*^9}, {3.682517527012473*^9, 3.682517554114517*^9}, 
   3.682530504255856*^9, {3.6825310789603157`*^9, 3.6825311294535637`*^9}, {
   3.682531162959876*^9, 3.682531200847205*^9}, 3.682531234224975*^9, 
   3.682531353507922*^9, {3.682531532559186*^9, 3.682531553164834*^9}, {
   3.6825317863358393`*^9, 3.682531894212888*^9}, {3.68257279074894*^9, 
   3.682572839218987*^9}, 3.6825729443627243`*^9, 3.682572992423419*^9, {
   3.682573071097989*^9, 3.68257310312551*^9}, 3.682573556637541*^9, 
   3.682576198820737*^9, 3.682579531823925*^9, {3.682580360920186*^9, 
   3.68258037407624*^9}, 3.682587841519602*^9, 3.682589441335536*^9, 
   3.682589716735856*^9, 3.682589869651217*^9, 3.682590426536211*^9, 
   3.682591035152299*^9, 3.682591134822015*^9, 3.68259121952143*^9, {
   3.682591377584577*^9, 3.682591435399942*^9}, 3.682591503499339*^9, {
   3.68259157331783*^9, 3.6825916202720013`*^9}, 3.682591801568048*^9, 
   3.682594338980853*^9, 3.6825944636137037`*^9, 3.6825945109453793`*^9, 
   3.682594617824524*^9, 3.68259501916371*^9, 3.682595049883459*^9, 
   3.6825963051451406`*^9, 3.682596344277729*^9, 3.682596384379768*^9, 
   3.682596461923011*^9, 3.68259721254912*^9, 3.6825973000173693`*^9, 
   3.682597620823976*^9, 3.682598295155303*^9, 3.68259832925805*^9, {
   3.682598493225546*^9, 3.682598538489438*^9}, {3.6825985779581327`*^9, 
   3.682598601246189*^9}, {3.682598754608539*^9, 3.6825987737468023`*^9}, {
   3.682601278411932*^9, 3.682601296532251*^9}, 3.682601396527279*^9, 
   3.6826063426395063`*^9, 3.682606518982213*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["eqCheck"], "Input",
 CellChangeTimes->{{3.682589722134655*^9, 3.682589723207967*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.682589723529231*^9, 3.68258987577423*^9, 3.68259104032231*^9, 
   3.682591243773645*^9, {3.682591381164412*^9, 3.6825914387214746`*^9}, {
   3.682591578647943*^9, 3.682591632603298*^9}, 3.682591808040605*^9, 
   3.682594360521037*^9, 3.682594621646554*^9, 3.682595026419776*^9, 
   3.6825950582452393`*^9, 3.682596316909346*^9, 3.682596348766226*^9, 
   3.682596389132688*^9, 3.68259646729723*^9, 3.682597634214658*^9, 
   3.6825986056189327`*^9, 3.682598758215075*^9, 3.6825987972044983`*^9, {
   3.6826012830648727`*^9, 3.682601300325783*^9}, 3.682601400216798*^9, 
   3.6826063478683767`*^9, 3.6826065229858007`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"checkBlockEquilibrium", "[", 
    RowBox[{"{", 
     RowBox[{"nRow_", ",", "j_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
       "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", "Rc",
        ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", "Ldb", 
       ",", "Vdb", ",", "Vtot", ",", "Htot", ",", "Mtot"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Lsu", ",", "Vsu", ",", "Lsb", ",", "Vsb", ",", "Ns", ",", "Ts", ",", 
         "Nc", ",", "Tc", ",", "Nd", ",", "Td", ",", "Rs", ",", "Vs", ",", 
         "Rc", ",", "Vc", ",", "Rd", ",", "Vd", ",", "Ldu", ",", "Vdu", ",", 
         "Ldb", ",", "Vdb"}], "}"}], "=", 
       RowBox[{"getBlockLoads", "[", 
        RowBox[{"{", 
         RowBox[{"nRow", ",", "j"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"isBlockHalved", "[", 
         RowBox[{"{", 
          RowBox[{"nRow", ",", "j"}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Vtot", "=", 
          RowBox[{"Vsu", "+", "Vsb", "+", "Ns", "+", "Nc", "+", 
           RowBox[{"P", "/", "2"}], "+", "Nd", "-", "Vdu", "-", "Vdb", "-", 
           "Rs", "-", "Rc", "-", "Rd"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Htot", "=", 
          RowBox[{
          "Lsu", "+", "Lsb", "+", "Ts", "+", "Tc", "+", "Td", "-", "Ldu", "-",
            "Ldb", "-", "Vs", "-", "Vc", "-", "Vd"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"isBlockOnLeftEdge", "[", 
            RowBox[{"{", 
             RowBox[{"nRow", ",", "j"}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Mtot", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                "Ns", "-", "Rs", "+", "Vsu", "+", "Vsb", "-", "Nd", "+", "Rd",
                  "+", "Vdu", "+", "Vdb", "-", 
                 RowBox[{
                  RowBox[{"P", "/", "2"}], "/", "2"}]}], ")"}], 
               RowBox[{"b", "/", "2"}]}], "-", 
              RowBox[{"h", 
               RowBox[{"(", 
                RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
                ")"}]}]}]}], ";"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Mtot", "=", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                "Ns", "-", "Rs", "+", "Vsu", "+", "Vsb", "-", "Nd", "+", "Rd",
                  "+", "Vdu", "+", "Vdb", "+", 
                 RowBox[{
                  RowBox[{"P", "/", "2"}], "/", "2"}]}], ")"}], 
               RowBox[{"b", "/", "2"}]}], "-", 
              RowBox[{"h", 
               RowBox[{"(", 
                RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
                ")"}]}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Vtot", "=", 
          RowBox[{
          "Vsu", "+", "Vsb", "+", "Ns", "+", "Nc", "+", "P", "+", "Nd", "-", 
           "Vdu", "-", "Vdb", "-", "Rs", "-", "Rc", "-", "Rd"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Htot", "=", 
          RowBox[{
          "Lsu", "+", "Lsb", "+", "Ts", "+", "Tc", "+", "Td", "-", "Ldu", "-",
            "Ldb", "-", "Vs", "-", "Vc", "-", "Vd"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Mtot", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
             "Ns", "-", "Rs", "+", "Vsu", "+", "Vsb", "-", "Nd", "+", "Rd", 
              "+", "Vdu", "+", "Vdb"}], ")"}], 
            RowBox[{"b", "/", "2"}]}], "-", 
           RowBox[{"h", 
            RowBox[{"(", 
             RowBox[{"Lsu", "-", "Ldu", "+", "Ts", "+", "Tc", "+", "Td"}], 
             ")"}]}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Vtot", ",", "Htot", ",", "Mtot"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682573768634943*^9, 3.682573896937772*^9}, {
   3.682573932186512*^9, 3.682573951635296*^9}, 3.6825739825320873`*^9, {
   3.682574080489026*^9, 3.6825742364630833`*^9}, {3.682574271875766*^9, 
   3.682574300270226*^9}, {3.682574342148508*^9, 3.682574345149973*^9}, {
   3.6825746291731043`*^9, 3.682574678408832*^9}, {3.6825747117680492`*^9, 
   3.682574717412869*^9}, {3.6825749194337177`*^9, 3.682574929223933*^9}, {
   3.6825880505988493`*^9, 3.682588097013589*^9}, {3.6825881341190977`*^9, 
   3.6825881442881937`*^9}, {3.682589570248972*^9, 3.682589618359652*^9}, 
   3.682590406106678*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"checkBlockEquilibrium", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], "]"}], "//", "Chop"}]], "Input",
 CellChangeTimes->{{3.682589811179315*^9, 3.682589817291999*^9}, 
   3.6825898830399714`*^9, {3.682591727098538*^9, 3.682591729985358*^9}, 
   3.682595568413208*^9, {3.682596002421187*^9, 3.6825960068445873`*^9}, 
   3.68259632242855*^9, 3.682596354881938*^9, 3.682596396990247*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.682589821440501*^9, {3.682589880016189*^9, 3.682589883551176*^9}, 
   3.6825917316970987`*^9, 3.682591812338312*^9, 3.6825955685908003`*^9, {
   3.682596002685906*^9, 3.682596012468966*^9}, {3.6825963200962553`*^9, 
   3.682596355120273*^9}, 3.682596397201891*^9, 3.682596471109881*^9, 
   3.6825972279043503`*^9, 3.682598610207012*^9, {3.682598760878318*^9, 
   3.682598778324212*^9}, 3.682601315478896*^9, 3.6826014028486433`*^9, 
   3.682603523665862*^9, 3.6826063514951468`*^9, 3.6826065259858227`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"c", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"nRow", "=", "1"}], ",", 
    RowBox[{"nRow", "\[LessEqual]", "nely"}], ",", 
    RowBox[{"nRow", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", 
        RowBox[{"getTotalBlocksInRow", "[", "nRow", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"checkBlockEquilibrium", "[", 
              RowBox[{"{", 
               RowBox[{"nRow", ",", "j"}], "}"}], "]"}], "//", "Chop"}], 
            ")"}], "\[NotEqual]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"c", ",", 
             RowBox[{"{", 
              RowBox[{"nRow", ",", "j"}], "}"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.682580434745882*^9, 3.682580480251851*^9}, {
   3.682580558955327*^9, 3.682580632956253*^9}, {3.682580663847383*^9, 
   3.682580736005609*^9}, {3.682580792598319*^9, 3.6825808163345547`*^9}, 
   3.682580921018551*^9, {3.682581533529029*^9, 3.682581534641169*^9}, 
   3.6825882280951653`*^9, 3.682591742237339*^9}],

Cell[CellGroupData[{

Cell[BoxData["c"], "Input",
 CellChangeTimes->{3.682580722842023*^9}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{
  3.682580722926046*^9, 3.6825807604581537`*^9, 3.6825809299770527`*^9, 
   3.6825879836404467`*^9, {3.68258821981145*^9, 3.682588230436079*^9}, 
   3.6825894977658052`*^9, 3.682589635601424*^9, 3.68258973484531*^9, 
   3.6825901575029182`*^9, 3.682591088354238*^9, 3.6825911581839323`*^9, 
   3.6825912398647614`*^9, 3.682591387824279*^9, 3.682591477510878*^9, {
   3.682591642080858*^9, 3.682591669652081*^9}, 3.6825917514161453`*^9, 
   3.682591819537951*^9, {3.682595075797141*^9, 3.682595082302862*^9}, 
   3.68259557921358*^9, 3.682596360143568*^9, 3.682596403681782*^9, 
   3.682596475676571*^9, 3.682598790238988*^9, 3.682601324552198*^9, 
   3.682601418861094*^9, 3.682606355368477*^9, 3.6826065290651283`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"applyLoads", "[", "]"}]], "Input",
 CellChangeTimes->{{3.68257496573993*^9, 3.6825749689494753`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nRow", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.682575100362214*^9, 3.6825751060886517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"blockSequence", "=", 
   RowBox[{"findSolvableBlockSequence", "[", "nRow", "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"blockSequence", "[", "\"\<seq\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", "5", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "8", ",", "7", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6825751320163403`*^9, 3.6825764407643213`*^9, 
  3.682601553298431*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"blockSequence", "[", "\"\<cri\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.682575303269999*^9, 3.682575303923936*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6825753046329107`*^9, 3.682576441688745*^9, 
  3.6826015566145973`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"j", "=", "1"}], ",", 
    RowBox[{"j", "<=", 
     RowBox[{"Length", "[", 
      RowBox[{"blockSequence", "[", "\"\<seq\>\"", "]"}], "]"}]}], ",", 
    RowBox[{"j", "++"}], ",", "\n", 
    RowBox[{
     RowBox[{"Do", "[", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"blockLoads", "=", 
         RowBox[{"getBlockLoads", "[", 
          RowBox[{"{", 
           RowBox[{"nRow", ",", "k"}], "}"}], "]"}]}], ";", "\n", 
        RowBox[{"contact", "=", 
         RowBox[{"contacts", "[", 
          RowBox[{"[", 
           RowBox[{"getBlockNum", "[", 
            RowBox[{"{", 
             RowBox[{"nRow", ",", "k"}], "}"}], "]"}], "]"}], "]"}]}], ";", 
        "\n", 
        RowBox[{"blockLoads", "=", 
         RowBox[{"solveBlock", "[", 
          RowBox[{"blockLoads", ",", "contact", ",", 
           RowBox[{"{", 
            RowBox[{"nRow", ",", "k"}], "}"}], ",", 
           RowBox[{
            RowBox[{"blockSequence", "[", "\"\<dir\>\"", "]"}], "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", "\n", 
        RowBox[{"updateStress", "[", 
         RowBox[{"blockLoads", ",", 
          RowBox[{"{", 
           RowBox[{"nRow", ",", "k"}], "}"}]}], "]"}], ";"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"k", ",", 
         RowBox[{
          RowBox[{"blockSequence", "[", "\"\<seq\>\"", "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], "}"}]}], "\n", "]"}], ";"}]}], 
   "\n", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6825750635332108`*^9, 3.6825750649873333`*^9}, {
  3.682575116860078*^9, 3.682575117900218*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"unbalancedBlocksData", "=", 
   RowBox[{"checkRowEquilibrium", "[", 
    RowBox[{"nRow", ",", 
     RowBox[{"blockSequence", "[", "\"\<cri\>\"", "]"}]}], "]"}]}], 
  ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"unbalancedBlocksData", "[", "\"\<eq_check\>\"", "]"}], "&&", 
  RowBox[{
   RowBox[{"Length", "[", 
    RowBox[{"unbalancedBlocksData", "[", "\"\<blocks\>\"", "]"}], "]"}], 
   "\[Equal]", "0"}]}]], "Input"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.682575405752651*^9, {3.682576150310954*^9, 3.682576158606361*^9}, 
   3.6825764491062317`*^9, 3.6826016621063128`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unbalancedBlocksData", "[", "\"\<blocks\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.6825754311937733`*^9, 3.682575434321786*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.682575426509756*^9, 3.682575434923881*^9}, 
   3.682576160718631*^9, 3.682576450160027*^9, 3.682601666192861*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"equilibrium", " ", "checks"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"unbalancedBlocksData", "[", "\"\<eq_check\>\"", "]"}], "&&", 
      RowBox[{
       RowBox[{"Length", "[", 
        RowBox[{"unbalancedBlocksData", "[", "\"\<blocks\>\"", "]"}], "]"}], 
       "\[Equal]", "0"}]}], ",", "\n", 
     RowBox[{"(*", 
      RowBox[{"row", " ", "is", " ", "already", " ", "balanced"}], "*)"}], 
     "\n", 
     RowBox[{
      RowBox[{"rowEqCheck", "=", "True"}], ";"}], ",", "\n", 
     RowBox[{"(*", 
      RowBox[{"start", " ", "correcting", " ", "unbalanced", " ", "blocks"}], 
      "*)"}], "\n", 
     RowBox[{
      RowBox[{"rowEqCheck", "=", 
       RowBox[{"startCorrectionWaves", "[", 
        RowBox[{"nRow", ",", "unbalancedBlocksData"}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.682575075533593*^9, 3.6825750774014473`*^9}, {
  3.682575384652416*^9, 3.682575387897498*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"startCorrectionWaves", "[", 
  RowBox[{"nRow", ",", "unbalancedBlocksData"}], "]"}]], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6825761800971823`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rowEqCheck", "=", "True"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"unbalancedBlocks", "=", 
   RowBox[{"unbalancedBlocksData", "[", "\"\<blocks\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"unbalancedBlockLoads", "=", 
   RowBox[{"unbalancedBlocksData", "[", "\"\<loads\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"directions", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"Length", "[", "unbalancedBlocks", "]"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.68257656593367*^9, 3.6825765830273952`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Length", "[", "unbalancedBlocks", "]"}], "!=", "0"}], "&&", 
  "rowEqCheck"}]], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.682576608331543*^9, 3.682601730386341*^9, 
  3.68260218069129*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"newUnbalancedBlocks", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"newUnbalancedBlockLoads", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"newDirections", "=", 
     RowBox[{"{", "}"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6826020811155567`*^9, 3.682602083643248*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"j", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.682576679045281*^9, 3.6825766835870247`*^9}, 
   3.682576762852003*^9, 3.682601908529525*^9, 3.682602096749856*^9, 
   3.6826021712731867`*^9, 3.682602214045949*^9, 3.6826029712123003`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unbalancedBlocks", "[", 
  RowBox[{"[", "j", "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{
  3.682602115936418*^9, {3.6826021875873823`*^9, 3.682602215892748*^9}, 
   3.682602973402866*^9, 3.6826035741352453`*^9, 3.6826040743926353`*^9, 
   3.682606249949574*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unbalancedBlockLoads", "[", 
  RowBox[{"[", "j", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.682603594137743*^9, 3.682603597779241*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "14.9`", ",", "0", ",", "2.0199999999999996`", ",", "0", ",", "0", ",", 
     "0", ",", "10", ",", 
     RowBox[{"-", "5"}], ",", "0", ",", "0", ",", "0.09999999999999964`", ",",
      "0.07999999999999972`", ",", "0", ",", "0.`", ",", "10.`", ",", "8.`", 
     ",", "0", ",", "0", ",", "3.8400000000000016`", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "3.8400000000000016`", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0.05`", ",", "0.`", ",", 
     "0", ",", "0.`", ",", "0.05`", ",", "0.`", ",", "4.799999999999999`", 
     ",", "0", ",", "4.040000000000003`", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.682603598842329*^9, 3.682606258009952*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["directions"], "Input"],

Cell[BoxData[
 RowBox[{"{", "1", "}"}]], "Output",
 CellChangeTimes->{3.682603861084861*^9, 3.682606260717496*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"nextBlocksData", "=", 
   RowBox[{"correctUnbalancedBlocks", "[", 
    RowBox[{"nRow", ",", 
     RowBox[{"unbalancedBlocks", "[", 
      RowBox[{"[", "j", "]"}], "]"}], ",", 
     RowBox[{"unbalancedBlockLoads", "[", 
      RowBox[{"[", "j", "]"}], "]"}], ",", 
     RowBox[{"directions", "[", 
      RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nextBlocksData", "[", "\"\<loads\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.682606298645493*^9, 3.682606324924199*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "14.9`", ",", "0", ",", "2.0199999999999996`", ",", "0", ",", "0", ",", 
     "0", ",", "10", ",", 
     RowBox[{"-", "5"}], ",", "0", ",", "0", ",", "0.09999999999999964`", ",",
      "0.07999999999999972`", ",", "0", ",", "0.`", ",", "10.`", ",", "8.`", 
     ",", "4.699999999999999`", ",", "0", ",", "4.060000000000002`", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.699999999999999`", ",", "0", ",", "4.060000000000002`", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0.1`", ",", 
     
     RowBox[{"-", "0.08000000000000002`"}], ",", "0", ",", "0.`", ",", "0", 
     ",", "0.`", ",", "4.799999999999999`", ",", "0", ",", 
     "4.040000000000003`", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.682606314089583*^9, 3.682606325674674*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"leftBlockLoads", ",", "rightBlockLoads"}], "}"}], "=", 
   RowBox[{"unbalancedBlockLoads", "[", 
    RowBox[{"[", "j", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"leftBlock", ",", "rightBlock"}], "}"}], "=", 
   RowBox[{"unbalancedBlocks", "[", 
    RowBox[{"[", "j", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rowEqCheck", "=", "True"}], ";", 
  RowBox[{"nextBlocks", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"nextBlockLoads", "=", 
   RowBox[{"{", "}"}]}], ";", 
  RowBox[{"nextDir", "=", "0"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6826039605759373`*^9, 3.6826039824670258`*^9}, {
  3.68260406330952*^9, 3.6826040902785597`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["rightBlockLoads"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "3.8400000000000016`", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0.05`", ",", "0.`", ",", "0",
    ",", "0.`", ",", "0.05`", ",", "0.`", ",", "4.799999999999999`", ",", "0",
    ",", "4.040000000000003`", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.682604184310216*^9, 3.682604592304414*^9, 
  3.682604680945487*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rightBlockLoads", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "4"}], "]"}], "]"}], "=", 
   RowBox[{"leftBlockLoads", "[", 
    RowBox[{"[", 
     RowBox[{"17", ";;", "20"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682604124585163*^9, 3.682604126115719*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nextLeftLoads", "=", 
   RowBox[{"correctBlock", "[", 
    RowBox[{"rightBlockLoads", ",", 
     RowBox[{"contacts", "[", 
      RowBox[{"[", 
       RowBox[{"getBlockNum", "[", 
        RowBox[{"{", 
         RowBox[{"nRow", ",", "rightBlock"}], "}"}], "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"nRow", ",", "rightBlock"}], "}"}]}], "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["nextBlocks"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{3.682605342959334*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["nextBlockLoads"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "10", ",", 
     "25", ",", "0", ",", "0", ",", "0", ",", "0.`", ",", "0", ",", "0.`", 
     ",", "10.1`", ",", "8.08`", ",", "14.9`", ",", "0", ",", 
     "2.0199999999999996`", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.699999999999999`", ",", "0", ",", "4.060000000000002`", ",", "0", ",", 
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0.1`", ",", 
     
     RowBox[{"-", "0.08000000000000002`"}], ",", "0", ",", "0.`", ",", "0", 
     ",", "0.`", ",", "4.799999999999999`", ",", "0", ",", 
     "4.040000000000003`", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.682605281771105*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getBlockLoads", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "4"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.682605381033915*^9, 3.682605392751321*^9}, 
   3.682605487817121*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.699999999999999`", ",", "0", ",", "4.060000000000002`", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0.1`", ",", 
   RowBox[{"-", "0.08000000000000002`"}], ",", "0", ",", "0.`", ",", "0", ",",
    "0.`", ",", "4.799999999999999`", ",", "0", ",", "4.040000000000003`", 
   ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.682605402448111*^9, 3.682605488093402*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkBlockEquilibrium", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "4"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.682605325498629*^9, 3.6826053610809927`*^9}, 
   3.682605492856555*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`", ",", 
   RowBox[{"-", "3.608224830031759`*^-16"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6826053491485853`*^9, 3.682605361340907*^9}, 
   3.68260549314289*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"updateStress", "[", 
   RowBox[{"nextLeftLoads", ",", 
    RowBox[{"{", 
     RowBox[{"nRow", ",", "rightBlock"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.682604211670785*^9, 3.682604212367345*^9}, {
  3.6826047363524723`*^9, 3.682604766455822*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nextLeftLoads", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "4"}], "]"}], "]"}], "!=", 
  RowBox[{"rightBlockLoads", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "4"}], "]"}], "]"}]}]], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.682605189631736*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"nextLeftLoads", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "4"}], "]"}], "]"}], "!=", 
     RowBox[{"rightBlockLoads", "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", "4"}], "]"}], "]"}]}], ",", "\n", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"left", " ", "interface", " ", "has", " ", "changed"}], ",", 
      " ", 
      RowBox[{
      "wave", " ", "continues", " ", "towards", " ", "the", " ", "left"}]}], 
     "*)"}], "\n", 
    RowBox[{
     RowBox[{"nextBlocks", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"leftBlock", "-", "1"}], ",", 
        RowBox[{"rightBlock", "-", "1"}]}], "}"}]}], ";", "\n", 
     RowBox[{"nextRightLoads", "=", "nextLeftLoads"}], ";", "\n", 
     RowBox[{"nextLeftLoads", "=", 
      RowBox[{"getBlockLoads", "[", 
       RowBox[{"{", 
        RowBox[{"nRow", ",", 
         RowBox[{"leftBlock", "-", "1"}]}], "}"}], "]"}]}], ";", "\n", 
     RowBox[{"nextBlockLoads", "=", 
      RowBox[{"{", 
       RowBox[{"nextLeftLoads", ",", "nextRightLoads"}], "}"}]}], ";", "\n", 
     RowBox[{"nextDir", "=", 
      RowBox[{"-", "1"}]}], ";"}]}], "\n", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.682605181970797*^9, 3.682605182920858*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rowEqCheck", "=", 
  RowBox[{"nextBlocksData", "[", "\"\<eq_check\>\"", "]"}]}]], "Input",
 CellChangeTimes->{
  3.682576880670735*^9, {3.682601948899794*^9, 3.6826019495540237`*^9}, {
   3.682602995995788*^9, 3.682603000480091*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6825768845934477`*^9, {3.682601924472789*^9, 3.682601950300128*^9}, {
   3.682602193286977*^9, 3.682602221492715*^9}, 3.682602985508754*^9, 
   3.6826030238658247`*^9, 3.682603684742873*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"nextBlocksData", "[", "\"\<blocks\>\"", "]"}], "]"}], "!=", 
     "0"}], ",", "\n", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"newUnbalancedBlocks", ",", 
       RowBox[{"nextBlocksData", "[", "\"\<blocks\>\"", "]"}]}], "]"}], ";", 
     "\n", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"newUnbalancedBlockLoads", ",", 
       RowBox[{"nextBlocksData", "[", "\"\<loads\>\"", "]"}]}], "]"}], ";", 
     "\n", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"newDirections", ",", 
       RowBox[{"nextBlocksData", "[", "\"\<dir\>\"", "]"}]}], "]"}], ";"}]}], 
   "\n", "]"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{"newUnbalancedBlocks", "\[IndentingNewLine]", \
"newUnbalancedBlockLoads", "\[IndentingNewLine]", "newDirections"}], "Input",
 CellChangeTimes->{{3.682602712676197*^9, 3.6826027190268707`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"2", ",", "3"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.682602002629735*^9, 3.68260219804592*^9, 3.682602232792274*^9, {
   3.68260269088577*^9, 3.682602739781314*^9}, 3.682603039888927*^9, {
   3.682603688863892*^9, 3.6826036967546997`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "10", ",", 
      "25", ",", "0", ",", "0", ",", "0", ",", "0.`", ",", "0", ",", "0.`", 
      ",", "10.1`", ",", "8.08`", ",", "14.9`", ",", "0", ",", 
      "2.0199999999999996`", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
     "4.699999999999999`", ",", "0", ",", "4.060000000000002`", ",", "0", ",",
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0.1`", 
      ",", 
      RowBox[{"-", "0.08000000000000002`"}], ",", "0", ",", "0.`", ",", "0", 
      ",", "0.`", ",", "4.799999999999999`", ",", "0", ",", 
      "4.040000000000003`", ",", "0"}], "}"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.682602002629735*^9, 3.68260219804592*^9, 3.682602232792274*^9, {
   3.68260269088577*^9, 3.682602739781314*^9}, 3.682603039888927*^9, {
   3.682603688863892*^9, 3.682603696759454*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.682602002629735*^9, 3.68260219804592*^9, 3.682602232792274*^9, {
   3.68260269088577*^9, 3.682602739781314*^9}, 3.682603039888927*^9, {
   3.682603688863892*^9, 3.682603696762936*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"getBlockLoads", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "5"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.6826031075229063`*^9, 3.682603121222143*^9}, {
   3.682603160765326*^9, 3.68260316717113*^9}, 3.6826034761189537`*^9, 
   3.682603542652832*^9, 3.682604272158258*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.799999999999999`", ",", "0", ",", "4.040000000000003`", ",", "0", ",", 
   "0", ",", "0", ",", "10", ",", "10", ",", "0", ",", "0", ",", "10.1`", ",", 
   RowBox[{"-", "8.08`"}], ",", "0", ",", "0.`", ",", "0", ",", "0.`", ",", 
   "24.9`", ",", "0", ",", "2.0200000000000014`", ",", "0"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.682603122059824*^9, {3.6826031618248158`*^9, 3.6826031676588287`*^9}, 
   3.682603476385029*^9, 3.682603542920967*^9, 3.682604272888888*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"checkBlockEquilibrium", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", "3"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.682603489457963*^9, 3.682603497503682*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", 
   RowBox[{"-", "4.920000000000002`"}], ",", "4.699999999999999`"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6826034981996307`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"j", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.682602279834215*^9, 3.682602282134305*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"leftLoads", "=", 
   RowBox[{"newUnbalancedBlockLoads", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"j", "-", "1"}], ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rightLoads", "=", 
   RowBox[{"newUnbalancedBlockLoads", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"j", "-", "1"}], ",", "2"}], "]"}], "]"}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"newUnbalancedBlockLoads", "[", 
  RowBox[{"[", 
   RowBox[{"2", ",", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6826025304006367`*^9, 3.6826026185871143`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.799999999999999`", ",", "0", ",", "4.040000000000003`", ",", "0", ",", 
   "0", ",", "0", ",", "10", ",", "10", ",", "0", ",", "0", ",", "10.1`", ",", 
   RowBox[{"-", "8.08`"}], ",", "0", ",", "0.`", ",", "0", ",", "0.`", ",", 
   "24.9`", ",", "0", ",", "2.0200000000000014`", ",", "0"}], "}"}]], "Output",\

 CellChangeTimes->{{3.682602533464374*^9, 3.682602536617477*^9}, 
   3.682602567900387*^9, {3.68260260476688*^9, 3.6826026194999866`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["rightLoads"], "Input",
 CellChangeTimes->{{3.68260249151927*^9, 3.682602521000864*^9}, {
  3.682602653453624*^9, 3.682602656846583*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "3.8400000000000016`", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0.05`", ",", "0.`", ",", "0",
    ",", "0.`", ",", "0.05`", ",", "0.`", ",", "4.799999999999999`", ",", "0",
    ",", "4.040000000000003`", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.682602493330263*^9, 3.682602522251781*^9}, {
  3.6826026574640627`*^9, 3.682602664953603*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"rightLoads", "[", 
    RowBox[{"[", 
     RowBox[{"17", ";;", "20"}], "]"}], "]"}], "=", 
   RowBox[{"newUnbalancedBlockLoads", "[", 
    RowBox[{"[", 
     RowBox[{"j", ",", "2", ",", 
      RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newUnbalancedBlocks", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{"newUnbalancedBlocks", ",", 
     RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"newUnbalancedBlockLoads", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{"newUnbalancedBlockLoads", ",", 
     RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"newUnbalancedBlockLoads", "[", 
    RowBox[{"[", 
     RowBox[{"j", "-", "1"}], "]"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"leftLoads", ",", "rightLoads"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"newDirections", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{"newDirections", ",", 
     RowBox[{"{", "j", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"newDirections", "[", 
    RowBox[{"[", 
     RowBox[{"j", "-", "1"}], "]"}], "]"}], "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.682602308987089*^9, 3.682602344138514*^9}, {
  3.682602471266036*^9, 3.6826024797611847`*^9}, {3.6826026404811296`*^9, 
  3.682602641591886*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"unbalancedBlocks", "=", "newUnbalancedBlocks"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"unbalancedBlockLoads", "=", "newUnbalancedBlockLoads"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"directions", "=", "newDirections"}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"(*", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.682602140048184*^9, 3.682602142031947*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rowEqCheck", "=", 
   RowBox[{"nextBlocksData", "[", "\"\<eq_check\>\"", "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.682602882466695*^9, 3.682602897147229*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"While", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "unbalancedBlocks", "]"}], "!=", "0"}], "&&", 
     "rowEqCheck"}], ",", "\n", 
    RowBox[{
     RowBox[{"newUnbalancedBlocks", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", 
     RowBox[{"newUnbalancedBlockLoads", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", 
     RowBox[{"newDirections", "=", 
      RowBox[{"{", "}"}]}], ";", "\n", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<=", 
        RowBox[{"Length", "[", "unbalancedBlocks", "]"}]}], ",", 
       RowBox[{"j", "++"}], ",", "\n", 
       RowBox[{
        RowBox[{"nextBlocksData", "=", 
         RowBox[{"correctUnbalancedBlocks", "[", 
          RowBox[{"nRow", ",", 
           RowBox[{"unbalancedBlocks", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"unbalancedBlockLoads", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"directions", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", "\n", 
        RowBox[{"rowEqCheck", "=", 
         RowBox[{"nextBlocksData", "[", "\"\<eq_check\>\"", "]"}]}], ";", 
        "\n", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"nextBlocksData", "[", "\"\<blocks\>\"", "]"}], "]"}], "!=",
            "0"}], ",", "\n", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"newUnbalancedBlocks", ",", 
             RowBox[{"nextBlocksData", "[", "\"\<blocks\>\"", "]"}]}], "]"}], 
           ";", "\n", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"newUnbalancedBlockLoads", ",", 
             RowBox[{"nextBlocksData", "[", "\"\<loads\>\"", "]"}]}], "]"}], 
           ";", "\n", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"newDirections", ",", 
             RowBox[{"nextBlocksData", "[", "\"\<dir\>\"", "]"}]}], "]"}], 
           ";"}]}], "\n", "]"}], ";"}]}], "\n", "]"}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"check", " ", "for", " ", "wave", " ", "collisions"}], "*)"}], 
     "\n", 
     RowBox[{"j", "=", "2"}], ";", "\n", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{"j", "<=", 
        RowBox[{"Length", "[", "newUnbalancedBlocks", "]"}]}], ",", "\n", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"check", " ", "for", " ", "non"}], "-", 
         RowBox[{"staggared", " ", "wave", " ", "collision"}]}], "*)"}], "\n", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"newUnbalancedBlocks", "[", 
            RowBox[{"[", 
             RowBox[{"j", "-", "1"}], "]"}], "]"}], "==", 
           RowBox[{"newUnbalancedBlocks", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ",", "\n", 
          RowBox[{
           RowBox[{"leftLoads", "=", 
            RowBox[{"newUnbalancedBlockLoads", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"j", "-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", "\n", 
           RowBox[{"rightLoads", "=", 
            RowBox[{"newUnbalancedBlockLoads", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "2"}], "]"}], "]"}]}], ";", "\n", 
           RowBox[{"newUnbalancedBlocks", "=", 
            RowBox[{"Drop", "[", 
             RowBox[{"newUnbalancedBlocks", ",", 
              RowBox[{"{", "j", "}"}]}], "]"}]}], ";", "\n", 
           RowBox[{"newUnbalancedBlockLoads", "=", 
            RowBox[{"Drop", "[", 
             RowBox[{"newUnbalancedBlockLoads", ",", 
              RowBox[{"{", "j", "}"}]}], "]"}]}], ";", "\n", 
           RowBox[{
            RowBox[{"newUnbalancedBlockLoads", "[", 
             RowBox[{"[", 
              RowBox[{"j", "-", "1"}], "]"}], "]"}], "=", 
            RowBox[{"{", 
             RowBox[{"leftLoads", ",", "rightLoads"}], "}"}]}], ";", "\n", 
           RowBox[{"newDirections", "=", 
            RowBox[{"Drop", "[", 
             RowBox[{"newDirections", ",", 
              RowBox[{"{", "j", "}"}]}], "]"}]}], ";", "\n", 
           RowBox[{
            RowBox[{"newDirections", "[", 
             RowBox[{"[", 
              RowBox[{"j", "-", "1"}], "]"}], "]"}], "=", "0"}], ";", "\n", 
           RowBox[{"j", "--"}], ";"}], ",", "\n", 
          RowBox[{"(*", 
           RowBox[{
           "check", " ", "for", " ", "staggared", " ", "wave", " ", 
            "collision"}], "*)"}], "\n", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"newUnbalancedBlocks", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"j", "-", "1"}], ",", "2"}], "]"}], "]"}], "==", 
              RowBox[{"newUnbalancedBlocks", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1"}], "]"}], "]"}]}], ",", "\n", 
             RowBox[{
              RowBox[{"leftLoads", "=", 
               RowBox[{"newUnbalancedBlockLoads", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"j", "-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
              "\n", 
              RowBox[{"rightLoads", "=", 
               RowBox[{"newUnbalancedBlockLoads", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"j", "-", "1"}], ",", "2"}], "]"}], "]"}]}], ";", 
              "\n", 
              RowBox[{
               RowBox[{"rightLoads", "[", 
                RowBox[{"[", 
                 RowBox[{"17", ";;", "20"}], "]"}], "]"}], "=", 
               RowBox[{"newUnbalancedBlockLoads", "[", 
                RowBox[{"[", 
                 RowBox[{"j", ",", "2", ",", 
                  RowBox[{"1", ";;", "4"}]}], "]"}], "]"}]}], ";", "\n", 
              RowBox[{"newUnbalancedBlocks", "=", 
               RowBox[{"Drop", "[", 
                RowBox[{"newUnbalancedBlocks", ",", 
                 RowBox[{"{", "j", "}"}]}], "]"}]}], ";", "\n", 
              RowBox[{"newUnbalancedBlockLoads", "=", 
               RowBox[{"Drop", "[", 
                RowBox[{"newUnbalancedBlockLoads", ",", 
                 RowBox[{"{", "j", "}"}]}], "]"}]}], ";", "\n", 
              RowBox[{
               RowBox[{"newUnbalancedBlockLoads", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "-", "1"}], "]"}], "]"}], "=", 
               RowBox[{"{", 
                RowBox[{"leftLoads", ",", "rightLoads"}], "}"}]}], ";", "\n", 
              
              RowBox[{"newDirections", "=", 
               RowBox[{"Drop", "[", 
                RowBox[{"newDirections", ",", 
                 RowBox[{"{", "j", "}"}]}], "]"}]}], ";", "\n", 
              RowBox[{
               RowBox[{"newDirections", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "-", "1"}], "]"}], "]"}], "=", "1"}], ";", "\n", 
              RowBox[{"j", "--"}], ";"}]}], "\n", "]"}], ";"}]}], "\n", "]"}],
         ";", "\n", 
        RowBox[{"j", "++"}], ";"}]}], "\n", "]"}], ";", "\n", "\n", 
     RowBox[{"unbalancedBlocks", "=", "newUnbalancedBlocks"}], ";", "\n", 
     RowBox[{"unbalancedBlockLoads", "=", "newUnbalancedBlockLoads"}], ";", 
     "\n", 
     RowBox[{"directions", "=", "newDirections"}], ";"}]}], "\n", "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682601896149378*^9, 3.682601898918468*^9}}]
}, Open  ]]
},
WindowSize->{683, 716},
WindowMargins->{{Automatic, -10}, {Automatic, -10}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 117, 1, 65, "Section"],
Cell[700, 25, 3476, 96, 297, "Input"],
Cell[4179, 123, 691, 22, 32, "Input"],
Cell[4873, 147, 6543, 173, 693, "Input"],
Cell[11419, 322, 8824, 229, 781, "Input"],
Cell[20246, 553, 874, 26, 165, "Input"],
Cell[21123, 581, 1554, 40, 319, "Input"],
Cell[22680, 623, 8425, 201, 1045, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31142, 829, 116, 1, 65, "Section"],
Cell[31261, 832, 2907, 92, 561, "Input"],
Cell[34171, 926, 12280, 291, 1331, "Input"],
Cell[46454, 1219, 4928, 128, 627, "Input"],
Cell[51385, 1349, 1548, 43, 187, "Input"],
Cell[52936, 1394, 6541, 158, 1001, "Input"],
Cell[59480, 1554, 2198, 54, 319, "Input"],
Cell[61681, 1610, 13012, 303, 1837, "Input"],
Cell[74696, 1915, 8749, 208, 1771, "Input"],
Cell[83448, 2125, 9804, 214, 1397, "Input"],
Cell[93255, 2341, 3826, 90, 627, "Input"],
Cell[97084, 2433, 1298, 34, 209, "Input"],
Cell[98385, 2469, 827, 24, 209, "Input"],
Cell[99215, 2495, 10813, 262, 1155, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110065, 2762, 119, 1, 65, "Section"],
Cell[110187, 2765, 1428, 40, 187, "Input"],
Cell[111618, 2807, 678, 19, 165, "Input"],
Cell[112299, 2828, 378, 12, 77, "Input"],
Cell[112680, 2842, 275, 9, 77, "Input"],
Cell[112958, 2853, 1013, 30, 143, "Input"],
Cell[113974, 2885, 351, 10, 121, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114362, 2900, 91, 1, 65, "Section"],
Cell[114456, 2903, 1652, 31, 77, "Input"],
Cell[116111, 2936, 255, 6, 55, "Input"],
Cell[116369, 2944, 5113, 95, 187, "Input"],
Cell[CellGroupData[{
Cell[121507, 3043, 296, 6, 55, "Input"],
Cell[121806, 3051, 15531, 282, 757, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137374, 3338, 99, 1, 32, "Input"],
Cell[137476, 3341, 675, 10, 32, "Output"]
}, Open  ]],
Cell[138166, 3354, 5027, 115, 561, "Input"],
Cell[CellGroupData[{
Cell[143218, 3473, 433, 8, 32, "Input"],
Cell[143654, 3483, 614, 10, 32, "Output"]
}, Open  ]],
Cell[144283, 3496, 1642, 41, 187, "Input"],
Cell[CellGroupData[{
Cell[145950, 3541, 69, 1, 32, "Input"],
Cell[146022, 3544, 785, 12, 32, "Output"]
}, Open  ]],
Cell[146822, 3559, 125, 2, 32, "Input"],
Cell[146950, 3563, 138, 3, 32, "Input"],
Cell[147091, 3568, 135, 3, 32, "Input"],
Cell[CellGroupData[{
Cell[147251, 3575, 76, 1, 32, "Input"],
Cell[147330, 3578, 386, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[147753, 3594, 142, 2, 32, "Input"],
Cell[147898, 3598, 264, 8, 32, "Output"]
}, Open  ]],
Cell[148177, 3609, 1645, 43, 209, "Input"],
Cell[149825, 3654, 217, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[150067, 3664, 242, 6, 32, "Input"],
Cell[150312, 3672, 175, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150524, 3680, 154, 2, 32, "Input"],
Cell[150681, 3684, 307, 8, 32, "Output"]
}, Open  ]],
Cell[151003, 3695, 1041, 27, 165, "Input"],
Cell[CellGroupData[{
Cell[152069, 3726, 118, 2, 32, "Input"],
Cell[152190, 3730, 75, 1, 32, "Output"]
}, Open  ]],
Cell[152280, 3734, 644, 18, 99, "Input"],
Cell[CellGroupData[{
Cell[152949, 3756, 135, 4, 32, "Input"],
Cell[153087, 3762, 119, 2, 32, "Output"]
}, Open  ]],
Cell[153221, 3767, 437, 13, 99, "Input"],
Cell[153661, 3782, 279, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[153965, 3791, 92, 2, 32, "Input"],
Cell[154060, 3795, 266, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154363, 3806, 162, 3, 32, "Input"],
Cell[154528, 3811, 817, 17, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155382, 3833, 36, 0, 32, "Input"],
Cell[155421, 3835, 114, 2, 32, "Output"]
}, Open  ]],
Cell[155550, 3840, 396, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[155971, 3854, 145, 2, 32, "Input"],
Cell[156119, 3858, 893, 19, 55, "Output"]
}, Open  ]],
Cell[157027, 3880, 769, 21, 143, "Input"],
Cell[CellGroupData[{
Cell[157821, 3905, 41, 0, 32, "Input"],
Cell[157865, 3907, 423, 8, 32, "Output"]
}, Open  ]],
Cell[158303, 3918, 324, 9, 32, "Input"],
Cell[158630, 3929, 412, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[159067, 3944, 36, 0, 32, "Input"],
Cell[159106, 3946, 115, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159258, 3954, 40, 0, 32, "Input"],
Cell[159301, 3956, 776, 17, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160114, 3978, 205, 5, 32, "Input"],
Cell[160322, 3985, 445, 8, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160804, 3998, 215, 5, 32, "Input"],
Cell[161022, 4005, 221, 5, 37, "Output"]
}, Open  ]],
Cell[161258, 4013, 299, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[161582, 4024, 232, 7, 32, "Input"],
Cell[161817, 4033, 73, 1, 32, "Output"]
}, Open  ]],
Cell[161905, 4037, 1288, 35, 187, "Input"],
Cell[CellGroupData[{
Cell[163218, 4076, 257, 5, 32, "Input"],
Cell[163478, 4083, 246, 4, 32, "Output"]
}, Open  ]],
Cell[163739, 4090, 723, 20, 121, "Input"],
Cell[CellGroupData[{
Cell[164487, 4114, 207, 2, 77, "Input"],
Cell[164697, 4118, 308, 7, 32, "Output"],
Cell[165008, 4127, 981, 21, 55, "Output"],
Cell[165992, 4150, 277, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[166306, 4161, 302, 6, 32, "Input"],
Cell[166611, 4169, 520, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167168, 4184, 187, 4, 32, "Input"],
Cell[167358, 4190, 185, 5, 32, "Output"]
}, Open  ]],
Cell[167558, 4198, 133, 3, 32, "Input"],
Cell[167694, 4203, 395, 12, 55, "Input"],
Cell[CellGroupData[{
Cell[168114, 4219, 193, 4, 32, "Input"],
Cell[168310, 4225, 494, 9, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168841, 4239, 150, 2, 32, "Input"],
Cell[168994, 4243, 451, 8, 32, "Output"]
}, Open  ]],
Cell[169460, 4254, 299, 9, 32, "Input"],
Cell[169762, 4265, 1054, 30, 121, "Input"],
Cell[170819, 4297, 396, 11, 99, "Input"],
Cell[171218, 4310, 201, 5, 32, "Input"],
Cell[171422, 4317, 7388, 174, 1023, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
